<!DOCTYPE html>

<html lang="ar" dir="rtl">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title data-i18n="title">ููุชุจุฉ ุฒูุงุฏ - ุงูุฑููุงู ููู 2026 โ</title>

    

    <meta name="theme-color" content="#050505">

    <meta name="apple-mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="apple-mobile-web-app-title" content="Ziad Library">

    <link rel="apple-touch-icon" href="favicon.png">

    

    <link rel="manifest" href="manifest.json">

    <link rel="icon" type="image/png" href="favicon.png">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;600;900&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>

    

    <style>

        :root {

            --primary: #00d4ff; --bg: #050505; --card: #0d1117;

            --text: #ffffff; --border: rgba(255,255,255,0.1); --danger: #ff4d4d;

            --success: #2ecc71;

        }

        [data-theme="light"] { --bg: #f0f2f5; --card: #ffffff; --text: #1a1a1a; --primary: #007bff; --border: rgba(0,0,0,0.1); }

        [data-theme="purple"] { --bg: #1a0b2e; --card: #2d1454; --text: #ffffff; --primary: #bc13fe; --border: rgba(255,255,255,0.1); }

        [data-theme="forest"] { --bg: #0a1a0a; --card: #142d14; --text: #ffffff; --primary: #2ecc71; --border: rgba(255,255,255,0.1); }

        [data-theme="sunset"] { --bg: #1a0f0f; --card: #2d1414; --text: #ffffff; --primary: #e67e22; --border: rgba(255,255,255,0.1); }

        [data-theme="gold"] { --bg: #11110a; --card: #222214; --text: #ffffff; --primary: #f1c40f; --border: rgba(255,255,255,0.1); }

        

        * { box-sizing: border-box; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; min-height: 100vh; overflow-x: hidden; }

        .floating-badge {

            position: fixed; bottom: 20px; right: 20px;

            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);

            border: 1px solid var(--primary); color: var(--primary);

            padding: 10px 20px; border-radius: 50px; font-weight: 900;

            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3); z-index: 9999;

            animation: pulse 2s infinite, float 3s ease-in-out infinite; display: none;

        }

        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(0,212,255,0.4); } 70% { box-shadow: 0 0 0 15px rgba(0,212,255,0); } }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        

        #loader { position: fixed; inset: 0; background: #000; display: flex; justify-content: center; align-items: center; z-index: 10000; }

        .spinner { width: 50px; height: 50px; border: 5px solid #111; border-top-color: var(--primary); border-radius: 50%; animation: spin 0.8s infinite ease-in-out; }

        @keyframes spin { to { transform: rotate(360deg); } }

        .header { text-align: center; padding: 30px 0; position: relative; }

        #settingsBtn { display: none; position: absolute; top: 60px; left: 15px; z-index: 100; }

        #downloadBtn { display: none; position: absolute; top: 15px; left: 15px; z-index: 100; }

        #themeToggle { display: none; position: absolute; top: 105px; left: 15px; z-index: 100; }

        .user-logo { width: 100px; height: 100px; border-radius: 20px; border: 2px solid var(--primary); box-shadow: 0 0 20px var(--primary); object-fit: cover; }

        .ziad-name { font-size: 2rem; font-weight: 900; text-shadow: 0 0 15px var(--primary); margin: 10px 0; }

        

        .glass-panel { background: rgba(255,255,255,0.03); backdrop-filter: blur(15px); border: 1px solid var(--border); border-radius: 25px; padding: 35px; width: 90%; max-width: 400px; margin: 40px auto; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        input, select, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: var(--text); text-align: center; font-family: 'Cairo'; outline: none; }

        input:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 10px var(--primary); }

        

        .btn { background: linear-gradient(45deg, #0056b3, var(--primary)); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: 700; cursor: pointer; width: 100%; font-size: 1rem; }

        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px var(--primary); }

        

        #libraryContent { display: none; padding: 20px; max-width: 1300px; margin: auto; animation: fadeIn 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        

        .top-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; gap: 15px; flex-wrap: wrap; }

        .status-chip { background: var(--card); padding: 8px 16px; border-radius: 50px; border: 1px solid var(--primary); cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; gap: 8px; font-weight: bold; }

        .status-chip:hover { background: var(--primary); color: #000; }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; z-index: 2000; padding: 0; backdrop-filter: blur(5px); }

        .modal-box { background: var(--card); max-width: 100%; margin: 0; padding: 0; border-radius: 0; border: none; position: relative; max-height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        .controls { display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 12px; background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 30px; border: 1px solid var(--border); }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }

        

        .card { background: var(--card); border-radius: 20px; padding: 12px; border: 1px solid var(--border); position: relative; overflow: hidden; display: flex; flex-direction: column; }

        .card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }

        .card-tag { position: absolute; top: 12px; right: 12px; background: var(--primary); color: #000; font-size: 0.7rem; padding: 4px 10px; border-radius: 8px; font-weight: 900; z-index: 5; }

        .preview { width: 100%; aspect-ratio: 3/4; border-radius: 12px; object-fit: cover; background: #111; cursor: pointer; }

        

        .book-title { font-weight: 900; color: var(--primary); text-align: center; margin: 10px 0 5px 0; font-size: 1.1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .book-author { font-size: 0.85rem; color: #ccc; text-align: center; margin-bottom: 5px; font-weight: 600; }

        .book-meta { font-size: 0.7rem; color: #777; margin-bottom: 10px; text-align: center; display: flex; justify-content: center; gap: 10px; }

        .card-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: auto; }

        .btn-s { padding: 8px; border-radius: 8px; border: none; font-weight: bold; font-size: 0.8rem; cursor: pointer; color: #fff; transition:0.2s; }

        .btn-edit { background: rgba(255,255,255,0.1); color: var(--primary); border: 1px solid var(--primary); grid-column: span 2; }

        

        .book-rating { color: #f1c40f; font-size: 0.9rem; margin-bottom: 5px; text-align: center; }

        #toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: var(--primary); color: #000; padding: 12px 30px; border-radius: 15px; font-weight: 800; display: none; z-index: 5000; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

        

        @media (max-width: 600px) {

            .grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }

            .controls { grid-template-columns: 1fr; }

        }

        .footer { text-align: center; padding: 40px; color: #666; font-size: 0.9rem; font-weight: bold; }

        svg.icon { width: 32px; height: 32px; margin-bottom: 5px; stroke: var(--primary); }

    </style>

</head>

<body data-theme="dark" data-lang="ar-EG">

    <div id="loader"><div class="spinner"></div></div>

    <div class="floating-badge" id="floatingBadge" data-i18n="floatingBadge">Ziad ุงูุจุงุจุง ๐</div>

    

    <div class="header">

        <div id="downloadBtn">

            <button class="status-chip" onclick="playAudio('click'); openDownloadModal()" data-i18n="downloadBooks">๐ ุชูุฒูู ูุชุจ</button>

        </div>

        <div id="settingsBtn">

            <button class="status-chip" onclick="playAudio('click'); openSettings()" data-i18n="settings">โ๏ธ ุชุธุจูุท ุงููุณุงุฆู</button>

        </div>

        <div id="themeToggle">

            <button class="status-chip" onclick="playAudio('click'); toggleTheme()" data-i18n="toggleTheme">ุชุจุฏูู ุงููุถุน ๐</button>

        </div>

        <img src="favicon.png" class="user-logo" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1043/1043322.png'">

        <div class="ziad-name" data-i18n="ziadName">Ziad Library <span style="font-size:1rem; vertical-align:middle; color:var(--primary)">VIP</span></div>

    </div>

    <div id="welcomePage" class="glass-panel" style="display:none">

        <h2 style="color:var(--primary); margin-top:0" data-i18n="welcomeTitle">ููุชุจุชู ุงูุฎุงุตุฉ ุจูููุฉ ูุฑูุฑู</h2>

        <p style="font-size:0.9rem; color:#aaa; margin-bottom:15px;" data-i18n="welcomeDesc">ูุฐู ููุชุจุฉ ุดุฎุตูุฉ ูุฅุฏุงุฑุฉ ูุชุจู ุงูุฅููุชุฑูููุฉ ุจุฃูุงู ูุฑููุงู.</p>

        <button class="btn" onclick="choosePasswordMode()" data-i18n="createPassword">ุงูุดู ูููุฉ ุงููุฑูุฑ</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="chooseNoPasswordMode()" data-i18n="startNoPassword">ุงุจุฏุง ุจุฏูู ูููุฉ ูุฑูุฑ</button>

    </div>

    <div id="loginPage" class="glass-panel">

        <h2 id="loginTitle" style="color:var(--primary); margin-top:0" data-i18n="loginTitle">ุฎุด ุจุฑุฌูู ุงููููู ูุง ูุนูู ๐ฆต</h2>

        <p id="loginDesc" style="font-size:0.9rem; color:#aaa; margin-bottom:15px; display:none" data-i18n="loginDesc">ุดููู ุฃูู ูุฑุฉ ุชุดุฑููุงุ ุงุนููู ูููุฉ ุณุฑ ุนุดุงู ูุญุฏุด ููุชุด ูู ูุชุจู:</p>

        <input type="password" id="passIn" placeholder="ูููุฉ ุงูุณุฑ ูุง ุดููู" data-i18n-placeholder="passwordPlaceholder">

        <div id="secSetup" style="display:none">

            <input type="text" id="secQuestion" placeholder="ุณุคุงู ุงูุฃูุงู (ูุซู: ุทููู ูุงูุ)" data-i18n-placeholder="secQuestionPlaceholder">

            <input type="text" id="secAnswer" placeholder="ุฅุฌุงุจุฉ ุงูุฃูุงู (ุงูุชูุฑูุง ูููุณ)" data-i18n-placeholder="secAnswerPlaceholder">

        </div>

        <button id="loginBtn" class="btn" onclick="handleAuth()" data-i18n="loginBtn">ุงูุชุญ ูุง ุณูุณู ๐</button>

        <p id="forgotPassLink" onclick="playAudio('click'); showPage('secPage')" style="cursor:pointer; font-size:0.8rem; margin-top:20px; color:#555" data-i18n="forgotPass">ูุณูุช ุงูุจุงุณูุฑุฏุ ูุจุฑ ุฏูุงุบู ูุฏูุณ ููุง</p>

        <button class="btn" style="background:#198754; margin-top:15px" onclick="playAudio('click'); openContactModal()" data-i18n="contactUs">ุชูุงุตู ูุนูุง ๐</button>

        <button class="btn" style="background:#6f42c1; margin-top:15px" onclick="playAudio('click'); openAboutModal()" data-i18n="aboutUs">ููุญุฉ ุนูุง โน๏ธ</button>

    </div>

    <div id="secPage" class="glass-panel" style="display:none">

        <h3 style="color:var(--primary)" data-i18n="forgotTitle">ูุณูุช ููุง ุฅููุ ๐ค</h3>

        <p style="font-size:0.9rem" id="secQuestionText" data-i18n="secQuestionText">ุณุคุงู ุงูุฃูุงู: </p>

        <input type="text" id="secAns" placeholder="ุงูุชุจ ุงูุฅุฌุงุจุฉ ููุง" data-i18n-placeholder="secAnsPlaceholder">

        <button class="btn" onclick="checkSec()" data-i18n="proceed">ููุง ุจููุง</button>

        <button class="btn" style="background:transparent; color:#777; margin-top:10px" onclick="playAudio('click'); showPage('loginPage')" data-i18n="back">ุงุฑุฌุน ูุง ูุฌููู</button>

    </div>

    <div id="libraryContent">

        <div class="top-nav">

            <div style="display:flex; gap:10px">

                <div class="status-chip" onclick="playAudio('popup');" id="storageChip" data-i18n="storage">๐พ ุงููุฎุฒู: <span id="totalStorage">0 KB</span></div>

                <div class="status-chip" onclick="playAudio('trash'); showBin()" style="border-color:var(--danger); color:var(--danger)" data-i18n="bin">๐๏ธ ุงูุฒุจุงูุฉ (<span id="binCount">0</span>)</div>

            </div>

            <div style="display:flex; gap:10px">

                <button class="status-chip" style="background:#198754; color:#fff; border:none" onclick="playAudio('success'); exportData()" data-i18n="export">๐ค ุฎุฏ ูุณุฎุฉ (ุชุตุฏูุฑ)</button>

                <button class="status-chip" style="background:#6f42c1; color:#fff; border:none" onclick="playAudio('click'); document.getElementById('importFile').click()" data-i18n="import">๐ฅ ุฑุฌุน ุงููุณุฎุฉ (ุงุณุชูุฑุงุฏ)</button>

                <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">

            </div>

        </div>

        <div class="controls">

            <input type="text" id="search" placeholder="๐ ุจุชุฏูุฑ ุนูู ุฅูู ูุง ุบุงููุ" oninput="render()" data-i18n-placeholder="searchPlaceholder">

            <select id="catFilter" onchange="playAudio('click'); render()">

                <option value="all" data-i18n="allCategories">๐ ููู ุนูู ุจุนุถู</option>

                <option value="ูุชุจ" data-i18n="booksCat">๐ ูุชุจ ุฌุฏ</option>

                <option value="ุฑูุงูุงุช" data-i18n="novelsCat">๐ญ ุฑูุงูุงุช ูุญูุงูุงุช</option>

                <option value="ููุฎุตุงุช" data-i18n="summariesCat">๐ ุจุฑุดุงูุฉ ุงูุงูุชุญุงูุงุช</option>

                <option value="ุฃุฎุฑู" data-i18n="othersCat">โจ ุญุงุฌุงุช ุชุงููุฉ</option>

            </select>

            <select id="sort" onchange="playAudio('click'); render()">

                <option value="new" data-i18n="sortNew">๐ ูุณู ูุงุตู</option>

                <option value="az" data-i18n="sortAz">๐ค ูู ุงูุฃูู ูููุงุก</option>

            </select>

            <button class="btn" onclick="playAudio('popup'); document.getElementById('fileIn').click()" data-i18n="uploadBtn">โ ุงุฑูุน ูุง ูุฌู</button>

            <input type="file" id="fileIn" accept=".pdf" style="display:none" onchange="upload(event)">

        </div>

        <div class="grid" id="grid"></div>

    </div>

    <div id="settingsModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0" data-i18n="settingsTitle">ุชุธุจูุท ุงููุณุงุฆู โ๏ธ</h4>

        <label data-i18n="themeLabel">ุงูุฑููุงู ูุงูุฃููุงู:</label>

        <select id="themeSelect" onchange="playAudio('click'); setTheme(this.value)">

            <option value="dark" data-i18n="darkTheme">ุถููุฉ (ููุนุธูุงุก)</option><option value="light" data-i18n="lightTheme">ููุฑ (ูุนูู ุงูุนูู)</option><option value="purple" data-i18n="purpleTheme">ุจููุณุฌู (ุฑููุงู)</option><option value="forest" data-i18n="forestTheme">ุบุงุจุฉ (ุทุจูุนุฉ)</option><option value="sunset" data-i18n="sunsetTheme">ุบุฑูุจ (ุฑููุงูุณู)</option><option value="gold" data-i18n="goldTheme">ุฏูุจู (ูุง ุจุงุดุง)</option>

        </select>

        <label data-i18n="languageLabel">ุชุบููุฑ ุงููุบุฉ:</label>

        <select id="langSelect" onchange="playAudio('click'); setLanguage(this.value)">

            <option value="ar-EG" data-i18n="egyptianArabic">ุงูุนุฑุจูุฉ ุงููุตุฑูุฉ</option>

            <option value="ar" data-i18n="standardArabic">ุงูุนุฑุจูุฉ ุงููุตุญู</option>

            <option value="en" data-i18n="english">English</option>

        </select>

        <button class="btn" onclick="playAudio('click'); openChangePassModal()" data-i18n="changePass">ุบูุฑ ูููุฉ ุงูุณุฑ ๐</button>

        <button class="btn" style="background:var(--danger); margin-top:15px" onclick="playAudio('trash'); deleteAllBooks()" data-i18n="deleteAll">ุงุญุฐู ููู ๐๏ธ</button>

        <button class="btn" style="background:#198754; margin-top:15px" onclick="playAudio('click'); openContactModal()" data-i18n="contactUs">ุชูุงุตู ูุนูุง ๐</button>

        <button class="btn" style="background:#6f42c1; margin-top:15px" onclick="playAudio('click'); openAboutModal()" data-i18n="aboutUs">ููุญุฉ ุนูุง โน๏ธ</button>

        <button class="btn" style="background:#333; margin-top:15px" onclick="playAudio('click'); closeModals()" data-i18n="close">ููู (ุฅุบูุงู)</button>

    </div></div>

    <div id="changePassModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0" data-i18n="changePassTitle">ุบูุฑ ูููุฉ ุงูุณุฑ ูุณุคุงู ุงูุฃูุงู</h4>

        <label data-i18n="newPassLabel">ูููุฉ ุงูุณุฑ ุงูุฌุฏูุฏุฉ:</label>

        <input type="password" id="newPassInput" placeholder="ุงูุชุจ ูููุฉ ุงูุณุฑ ุงูุฌุฏูุฏุฉ" data-i18n-placeholder="newPassPlaceholder">

        <label data-i18n="newSecQLabel">ุณุคุงู ุงูุฃูุงู ุงูุฌุฏูุฏ:</label>

        <input type="text" id="newSecQuestion" placeholder="ุณุคุงู ุงูุฃูุงู ุงูุฌุฏูุฏ (ูุซู: ุทููู ูุงูุ)" data-i18n-placeholder="newSecQPlaceholder">

        <label data-i18n="newSecALabel">ุฅุฌุงุจุฉ ุงูุฃูุงู ุงูุฌุฏูุฏุฉ:</label>

        <input type="text" id="newSecAnswer" placeholder="ุฅุฌุงุจุฉ ุงูุฃูุงู ุงูุฌุฏูุฏุฉ" data-i18n-placeholder="newSecAPlaceholder">

        <button class="btn" onclick="playAudio('success'); saveNewPassAndSec()" data-i18n="saveChanges">ุงุนุชูุฏ ุงูุชุบููุฑุงุช ๐</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()" data-i18n="close">ุฅุบูุงู</button>

    </div></div>

    <div id="aboutModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0" data-i18n="aboutTitle">ููุญุฉ ุนูุง</h4>

        <p style="font-size:0.9rem; color:#aaa; margin-bottom:15px;" data-i18n="aboutDesc">ุฏู ูููุน ููุชุจุฉ ุฒูุงุฏุ ุงูุฑููุงู ููู 2026 โุ ุนุดุงู ุชุฏูุฑ ูุชุจู ุงูุฅููุชุฑูููุฉ ุจุฃูุงู ูุณูููุฉ ูุง ูุนูู. ููุง ุชูุฏุฑ ุชุฑูุน ูุชุจู ุงูู PDFุ ุชุตูููุงุ ุชุจุญุซ ูููุงุ ุชูุฑุงูุงุ ูุชุญูููุง ุฒู ูุง ุงูุช ุนุงูุฒ. ุงูููุชุจุฉ ุฏู ุดุฎุตูุฉ ุชูุงููุงุ ูุน ูููุฉ ูุฑูุฑ ุนุดุงู ูุญุฏุด ููุชุด ูู ุญุงุฌุงุชูุ ููููุง ุฎุงุตูุฉ ุชุตุฏูุฑ ูุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุนุดุงู ุชููู ูุชุจู ุจุณูููุฉ. ููุงู ูููุง ุณูุฉ ููููุงุช ุนุดุงู ูู ุบูุทุช ูู ุญุฐู ุญุงุฌุฉ ุชูุฏุฑ ุชุฑุฌุนูุงุ ูุชุบููุฑ ุงูุซููุงุช ุนุดุงู ุชุฑูุญ ุนูููู. ูู ุฏู ูุตูู ุจุฃุญุฏุซ ุงูุชูููุงุช ุนุดุงู ูุดุชุบู ุขููุงูู ููุงู ุฒู ุงูู PWA. ูู ุตูุน ูุฅุนุฏุงุฏ ุฒูุงุฏ ุงูุฏุฑูููุ ูุง ุฑูุณ!</p>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()" data-i18n="close">ุฅุบูุงู</button>

    </div></div>

    <div id="contactModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0" data-i18n="contactTitle">ุชูุงุตู ูุนูุง ๐ฌ</h4>

        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">

            <div style="text-align: center; padding: 15px; background: var(--card); border: 1px solid var(--border); border-radius: 15px;">

                <svg class="icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>

                <div style="font-weight: bold; color: var(--primary);" data-i18n="phoneWhatsapp">ุงุชุตุงู/ูุงุชุณุงุจ</div>

                <a href="tel:01055662785" class="btn-s" style="background:var(--primary); color:#000; margin-top:5px; display:block; text-decoration:none;" data-i18n="call">ุงุชุตุงู</a>

                <a href="https://wa.me/01055662785" target="_blank" class="btn-s" style="background:#25D366; color:#fff; margin-top:5px; display:block; text-decoration:none;" data-i18n="whatsapp">ูุงุชุณุงุจ</a>

            </div>

            <div style="text-align: center; padding: 15px; background: var(--card); border: 1px solid var(--border); border-radius: 15px;">

                <svg class="icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>

                <div style="font-weight: bold; color: var(--primary);" data-i18n="facebook">ููุณุจูู</div>

                <a href="https://www.facebook.com/profile.php?id=61583039190517&locale=ar_AR" target="_blank" style="color: #1877F2; text-decoration: none;" data-i18n="visitPage">ุฒูุงุฑุฉ ุงูุตูุญุฉ</a>

            </div>

            <div style="text-align: center; padding: 15px; background: var(--card); border: 1px solid var(--border); border-radius: 15px;">

                <svg class="icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M17.25,5.5A1.25,1.25 0 0,1 18.5,6.75A1.25,1.25 0 0,1 17.25,8A1.25,1.25 0 0,1 16,6.75A1.25,1.25 0 0,1 17.25,5.5M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z"/></svg>

                <div style="font-weight: bold; color: var(--primary);" data-i18n="instagram">ุฅูุณุชุบุฑุงู</div>

                <a href="https://www.instagram.com/ziadalzoz1020/" target="_blank" class="btn-s" style="background:linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); color:#fff; margin-top:5px; display:block; text-decoration:none;" data-i18n="instagramBtn">ุฅูุณุชุบุฑุงู</a>

            </div>

        </div>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()" data-i18n="close">ุฅุบูุงู</button>

    </div></div>

    <div id="uploadModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary)" data-i18n="uploadTitle">ูุงุช ูุง ุนูุฏู ูุง ูุจุฏุน</h4>

        <div id="pendingFileName" style="font-size:0.8rem; color:#888; margin-bottom:10px"></div>

        <label data-i18n="bookNameLabel">ุงุณู ุงููุชุงุจ (ุนุดุงู ูุชุชููุด):</label>

        <input type="text" id="bookNameInput" placeholder="ุงูุชุจ ุงูุงุณู ููุง" data-i18n-placeholder="bookNamePlaceholder">

        <label data-i18n="authorLabel">ููู ุงููู ูุชุจูุ:</label>

        <input type="text" id="authorInput" placeholder="ุงุณู ุงููุคูู (ูู ูุด ุนุงุฑู ุงูุชุจ 'ูุงุญุฏ ูุนุฑููุด')" data-i18n-placeholder="authorPlaceholder">

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px">

            <div>

                <label data-i18n="categoryLabel">ููุนู ุฅููุ:</label>

                <select id="selectedCat"><option value="ูุชุจ" data-i18n="booksCat">ูุชุจ</option><option value="ุฑูุงูุงุช" data-i18n="novelsCat">ุฑูุงูุงุช</option><option value="ููุฎุตุงุช" data-i18n="summariesCat">ููุฎุตุงุช</option><option value="ุฃุฎุฑู" data-i18n="othersCat">ูููุชูู</option></select>

            </div>

            <div>

                <label data-i18n="ratingLabel">ูุณุชุงูู ูุงูุ:</label>

                <select id="bookRatingInput">

                    <option value="5" data-i18n="rating5">โญโญโญโญโญ ุนุงููู</option><option value="4" data-i18n="rating4">โญโญโญโญ ุฌุงูุฏ</option><option value="3" data-i18n="rating3">โญโญโญ ุดุบุงู</option><option value="2" data-i18n="rating2">โญโญ ูุด ูุฏ ูุฏุฉ</option><option value="1" data-i18n="rating1">โญ ูุถูุน ุงูููุช</option>

                </select>

            </div>

        </div>

        <label data-i18n="descLabel">ูููุชูู ูู ุญู ุงููุชุงุจ:</label>

        <textarea id="bookDescInput" rows="3" placeholder="ุงุญูู ุจุงุฎุชุตุงุฑ..." data-i18n-placeholder="descPlaceholder"></textarea>

        <button class="btn" id="confirmUploadBtn" data-i18n="confirmUpload">ุทูุฑ ุงููุชุงุจ ููููุชุจุฉ ๐</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()" data-i18n="cancel">ููุณู ูุง ุนู</button>

    </div></div>

    <div id="editModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary)" data-i18n="editTitle">ุนุฏู ุจุฑุงุญุชู</h4>

        <input type="hidden" id="editBookId">

        <label data-i18n="bookNameLabel">ุงุณู ุงููุชุงุจ:</label>

        <input type="text" id="editName">

        <label data-i18n="authorLabel">ุงููุคูู:</label>

        <input type="text" id="editAuthor">

        <label data-i18n="categoryLabel">ุงูุชุตููู:</label>

        <select id="editCat"><option value="ูุชุจ" data-i18n="booksCat">ูุชุจ</option><option value="ุฑูุงูุงุช" data-i18n="novelsCat">ุฑูุงูุงุช</option><option value="ููุฎุตุงุช" data-i18n="summariesCat">ููุฎุตุงุช</option><option value="ุฃุฎุฑู" data-i18n="othersCat">ูููุชูู</option></select>

        <label data-i18n="descLabel">ุงููุตู:</label>

        <textarea id="editDesc" rows="3"></textarea>

        <button class="btn" onclick="saveEdit()" data-i18n="saveEdit">ุณูู ุงูุชุนุฏููุงุช ๐พ</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="closeModals()" data-i18n="cancelEdit">ุฎูุงุต ูุด ูุนุฏู</button>

    </div></div>

    <div id="binModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--danger)" data-i18n="binTitle">ููุจ ุงูููุงูุงุช ๐๏ธ</h4>

        <div id="binList"></div>

        <button class="btn" style="background:var(--danger)" onclick="emptyBin()" data-i18n="emptyBin">ูุฑูุชุฉ (ุญุฐู ุงููู)</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()" data-i18n="closeBin">ุงููู ุงูุฑูุญุฉ ุทุงูุนุฉ ๐ท</button>

    </div></div>

    <div id="downloadModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0" data-i18n="chooseLibrary">ุงุฎุชุฑ ุงูููุชุจุฉ</h4>

        <button class="btn" onclick="window.open('https://www.noor-book.com/', '_blank')" data-i18n="noorLibrary">ููุชุจุฉ ููุฑ</button>

        <button class="btn" style="margin-top:10px" onclick="window.open('https://www.kotobati.com/', '_blank')" data-i18n="kotobatiLibrary">ููุชุจุฉ ูุชูุจุงุชู</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()" data-i18n="close">ุฅุบูุงู</button>

    </div></div>

    <div id="toast"></div>

    <div class="footer" data-i18n="footer">ุตูุน ุจูู ุฑููุงู ุจูุงุณุทุฉ Ziad Library Pro &copy; 2026 โ</div>

    <script>

        if ('serviceWorker' in navigator) {

            window.addEventListener('load', () => {

                const swCode = `

                    const CACHE_NAME = 'ziad-lib-v1';

                    self.addEventListener('install', e => e.waitUntil(caches.open(CACHE_NAME).then(c => c.addAll(['/']))));

                    self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))));

                `;

                const blob = new Blob([swCode], { type: 'text/javascript' });

                const swUrl = URL.createObjectURL(blob);

                navigator.serviceWorker.register(swUrl).catch(console.error);

            });

        }

        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        

        const sounds = {

            click: "https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3",

            success: "https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3",

            trash: "https://assets.mixkit.co/active_storage/sfx/2570/2570-preview.mp3",

            error: "https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.mp3",

            popup: "https://assets.mixkit.co/active_storage/sfx/2580/2580-preview.mp3",

            engine: "https://assets.mixkit.co/active_storage/sfx/876/876-preview.mp3"

        };

        

        function playAudio(type) {

            const audio = new Audio(sounds[type]);

            audio.volume = 0.5;

            audio.play().catch(e => console.log("Audio blocked"));

        }

        

        const translations = {

            'ar-EG': {

                title: 'ููุชุจุฉ ุฒูุงุฏ - ุงูุฑููุงู ููู 2026 โ',

                floatingBadge: 'Ziad ุงูุจุงุจุง ๐',

                downloadBooks: '๐ ุชูุฒูู ูุชุจ',

                settings: 'โ๏ธ ุชุธุจูุท ุงููุณุงุฆู',

                toggleTheme: 'ุชุจุฏูู ุงููุถุน ๐',

                ziadName: 'Ziad Library VIP',

                welcomeTitle: 'ููุชุจุชู ุงูุฎุงุตุฉ ุจูููุฉ ูุฑูุฑู',

                welcomeDesc: 'ูุฐู ููุชุจุฉ ุดุฎุตูุฉ ูุฅุฏุงุฑุฉ ูุชุจู ุงูุฅููุชุฑูููุฉ ุจุฃูุงู ูุฑููุงู.',

                createPassword: 'ุงูุดู ูููุฉ ุงููุฑูุฑ',

                startNoPassword: 'ุงุจุฏุง ุจุฏูู ูููุฉ ูุฑูุฑ',

                loginTitle: 'ุฎุด ุจุฑุฌูู ุงููููู ูุง ูุนูู ๐ฆต',

                loginDesc: 'ุดููู ุฃูู ูุฑุฉ ุชุดุฑููุงุ ุงุนููู ูููุฉ ุณุฑ ุนุดุงู ูุญุฏุด ููุชุด ูู ูุชุจู:',

                passwordPlaceholder: 'ูููุฉ ุงูุณุฑ ูุง ุดููู',

                secQuestionPlaceholder: 'ุณุคุงู ุงูุฃูุงู (ูุซู: ุทููู ูุงูุ)',

                secAnswerPlaceholder: 'ุฅุฌุงุจุฉ ุงูุฃูุงู (ุงูุชูุฑูุง ูููุณ)',

                loginBtn: 'ุงูุชุญ ูุง ุณูุณู ๐',

                forgotPass: 'ูุณูุช ุงูุจุงุณูุฑุฏุ ูุจุฑ ุฏูุงุบู ูุฏูุณ ููุง',

                contactUs: 'ุชูุงุตู ูุนูุง ๐',

                aboutUs: 'ููุญุฉ ุนูุง โน๏ธ',

                forgotTitle: 'ูุณูุช ููุง ุฅููุ ๐ค',

                secQuestionText: 'ุณุคุงู ุงูุฃูุงู: ',

                secAnsPlaceholder: 'ุงูุชุจ ุงูุฅุฌุงุจุฉ ููุง',

                proceed: 'ููุง ุจููุง',

                back: 'ุงุฑุฌุน ูุง ูุฌููู',

                storage: '๐พ ุงููุฎุฒู: ',

                bin: '๐๏ธ ุงูุฒุจุงูุฉ ',

                export: '๐ค ุฎุฏ ูุณุฎุฉ (ุชุตุฏูุฑ)',

                import: '๐ฅ ุฑุฌุน ุงููุณุฎุฉ (ุงุณุชูุฑุงุฏ)',

                searchPlaceholder: '๐ ุจุชุฏูุฑ ุนูู ุฅูู ูุง ุบุงููุ',

                allCategories: '๐ ููู ุนูู ุจุนุถู',

                booksCat: '๐ ูุชุจ ุฌุฏ',

                novelsCat: '๐ญ ุฑูุงูุงุช ูุญูุงูุงุช',

                summariesCat: '๐ ุจุฑุดุงูุฉ ุงูุงูุชุญุงูุงุช',

                othersCat: 'โจ ุญุงุฌุงุช ุชุงููุฉ',

                sortNew: '๐ ูุณู ูุงุตู',

                sortAz: '๐ค ูู ุงูุฃูู ูููุงุก',

                uploadBtn: 'โ ุงุฑูุน ูุง ูุฌู',

                settingsTitle: 'ุชุธุจูุท ุงููุณุงุฆู โ๏ธ',

                themeLabel: 'ุงูุฑููุงู ูุงูุฃููุงู:',

                darkTheme: 'ุถููุฉ (ููุนุธูุงุก)',

                lightTheme: 'ููุฑ (ูุนูู ุงูุนูู)',

                purpleTheme: 'ุจููุณุฌู (ุฑููุงู)',

                forestTheme: 'ุบุงุจุฉ (ุทุจูุนุฉ)',

                sunsetTheme: 'ุบุฑูุจ (ุฑููุงูุณู)',

                goldTheme: 'ุฏูุจู (ูุง ุจุงุดุง)',

                languageLabel: 'ุชุบููุฑ ุงููุบุฉ:',

                egyptianArabic: 'ุงูุนุฑุจูุฉ ุงููุตุฑูุฉ',

                standardArabic: 'ุงูุนุฑุจูุฉ ุงููุตุญู',

                english: 'English',

                changePass: 'ุบูุฑ ูููุฉ ุงูุณุฑ ๐',

                deleteAll: 'ุงุญุฐู ููู ๐๏ธ',

                close: 'ููู (ุฅุบูุงู)',

                changePassTitle: 'ุบูุฑ ูููุฉ ุงูุณุฑ ูุณุคุงู ุงูุฃูุงู',

                newPassLabel: 'ูููุฉ ุงูุณุฑ ุงูุฌุฏูุฏุฉ:',

                newPassPlaceholder: 'ุงูุชุจ ูููุฉ ุงูุณุฑ ุงูุฌุฏูุฏุฉ',

                newSecQLabel: 'ุณุคุงู ุงูุฃูุงู ุงูุฌุฏูุฏ:',

                newSecQPlaceholder: 'ุณุคุงู ุงูุฃูุงู ุงูุฌุฏูุฏ (ูุซู: ุทููู ูุงูุ)',

                newSecALabel: 'ุฅุฌุงุจุฉ ุงูุฃูุงู ุงูุฌุฏูุฏุฉ:',

                newSecAPlaceholder: 'ุฅุฌุงุจุฉ ุงูุฃูุงู ุงูุฌุฏูุฏุฉ',

                saveChanges: 'ุงุนุชูุฏ ุงูุชุบููุฑุงุช ๐',

                aboutTitle: 'ููุญุฉ ุนูุง',

                aboutDesc: 'ุฏู ูููุน ููุชุจุฉ ุฒูุงุฏุ ุงูุฑููุงู ููู 2026 โุ ุนุดุงู ุชุฏูุฑ ูุชุจู ุงูุฅููุชุฑูููุฉ ุจุฃูุงู ูุณูููุฉ ูุง ูุนูู. ููุง ุชูุฏุฑ ุชุฑูุน ูุชุจู ุงูู PDFุ ุชุตูููุงุ ุชุจุญุซ ูููุงุ ุชูุฑุงูุงุ ูุชุญูููุง ุฒู ูุง ุงูุช ุนุงูุฒ. ุงูููุชุจุฉ ุฏู ุดุฎุตูุฉ ุชูุงููุงุ ูุน ูููุฉ ูุฑูุฑ ุนุดุงู ูุญุฏุด ููุชุด ูู ุญุงุฌุงุชูุ ููููุง ุฎุงุตูุฉ ุชุตุฏูุฑ ูุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุนุดุงู ุชููู ูุชุจู ุจุณูููุฉ. ููุงู ูููุง ุณูุฉ ููููุงุช ุนุดุงู ูู ุบูุทุช ูู ุญุฐู ุญุงุฌุฉ ุชูุฏุฑ ุชุฑุฌุนูุงุ ูุชุบููุฑ ุงูุซููุงุช ุนุดุงู ุชุฑูุญ ุนูููู. ูู ุฏู ูุตูู ุจุฃุญุฏุซ ุงูุชูููุงุช ุนุดุงู ูุดุชุบู ุขููุงูู ููุงู ุฒู ุงูู PWA. ูู ุตูุน ูุฅุนุฏุงุฏ ุฒูุงุฏ ุงูุฏุฑูููุ ูุง ุฑูุณ!',

                contactTitle: 'ุชูุงุตู ูุนูุง ๐ฌ',

                phoneWhatsapp: 'ุงุชุตุงู/ูุงุชุณุงุจ',

                call: 'ุงุชุตุงู',

                whatsapp: 'ูุงุชุณุงุจ',

                facebook: 'ููุณุจูู',

                visitPage: 'ุฒูุงุฑุฉ ุงูุตูุญุฉ',

                instagram: 'ุฅูุณุชุบุฑุงู',

                instagramBtn: 'ุฅูุณุชุบุฑุงู',

                uploadTitle: 'ูุงุช ูุง ุนูุฏู ูุง ูุจุฏุน',

                bookNameLabel: 'ุงุณู ุงููุชุงุจ (ุนุดุงู ูุชุชููุด):',

                bookNamePlaceholder: 'ุงูุชุจ ุงูุงุณู ููุง',

                authorLabel: 'ููู ุงููู ูุชุจูุ:',

                authorPlaceholder: "ุงุณู ุงููุคูู (ูู ูุด ุนุงุฑู ุงูุชุจ 'ูุงุญุฏ ูุนุฑููุด')",

                categoryLabel: 'ููุนู ุฅููุ:',

                ratingLabel: 'ูุณุชุงูู ูุงูุ:',

                rating5: 'โญโญโญโญโญ ุนุงููู',

                rating4: 'โญโญโญโญ ุฌุงูุฏ',

                rating3: 'โญโญโญ ุดุบุงู',

                rating2: 'โญโญ ูุด ูุฏ ูุฏุฉ',

                rating1: 'โญ ูุถูุน ุงูููุช',

                descLabel: 'ูููุชูู ูู ุญู ุงููุชุงุจ:',

                descPlaceholder: 'ุงุญูู ุจุงุฎุชุตุงุฑ...',

                confirmUpload: 'ุทูุฑ ุงููุชุงุจ ููููุชุจุฉ ๐',

                cancel: 'ููุณู ูุง ุนู',

                editTitle: 'ุนุฏู ุจุฑุงุญุชู',

                saveEdit: 'ุณูู ุงูุชุนุฏููุงุช ๐พ',

                cancelEdit: 'ุฎูุงุต ูุด ูุนุฏู',

                binTitle: 'ููุจ ุงูููุงูุงุช ๐๏ธ',

                emptyBin: 'ูุฑูุชุฉ (ุญุฐู ุงููู)',

                closeBin: 'ุงููู ุงูุฑูุญุฉ ุทุงูุนุฉ ๐ท',

                chooseLibrary: 'ุงุฎุชุฑ ุงูููุชุจุฉ',

                noorLibrary: 'ููุชุจุฉ ููุฑ',

                kotobatiLibrary: 'ููุชุจุฉ ูุชูุจุงุชู',

                footer: 'ุตูุน ุจูู ุฑููุงู ุจูุงุณุทุฉ Ziad Library Pro &copy; 2026 โ'

            },

            'ar': {

                title: 'ููุชุจุฉ ุฒูุงุฏ - ุงูุฑุงุญุฉ ูููุง 2026 โ',

                floatingBadge: 'ุฒูุงุฏ ุงูุฃุจ ๐',

                downloadBooks: '๐ ุชูุฒูู ูุชุจ',

                settings: 'โ๏ธ ุฅุนุฏุงุฏุงุช',

                toggleTheme: 'ุชุจุฏูู ุงููุถุน ๐',

                ziadName: 'ููุชุจุฉ ุฒูุงุฏ VIP',

                welcomeTitle: 'ููุชุจุชู ุงูุฎุงุตุฉ ุจูููุฉ ูุฑูุฑ',

                welcomeDesc: 'ูุฐู ููุชุจุฉ ุดุฎุตูุฉ ูุฅุฏุงุฑุฉ ูุชุจู ุงูุฅููุชุฑูููุฉ ุจุฃูุงู ูุฑุงุญุฉ.',

                createPassword: 'ุฅูุดุงุก ูููุฉ ุงููุฑูุฑ',

                startNoPassword: 'ุงุจุฏุฃ ุจุฏูู ูููุฉ ูุฑูุฑ',

                loginTitle: 'ุงุฏุฎู ุจูุฏูู ุงููููู ุฃููุง ุงูุณูุฏ ๐ฆต',

                loginDesc: 'ูุจุฏู ุฃููุง ุงููุฑุฉ ุงูุฃูููุ ุฃูุดุฆ ูููุฉ ูุฑูุฑ ูููุน ุงูุขุฎุฑูู ูู ุงููุตูู ุฅูู ูุชุจู:',

                passwordPlaceholder: 'ูููุฉ ุงููุฑูุฑ',

                secQuestionPlaceholder: 'ุณุคุงู ุงูุฃูุงู (ูุซู: ูุง ุทูููุ)',

                secAnswerPlaceholder: 'ุฅุฌุงุจุฉ ุงูุฃูุงู (ุชุฐูุฑูุง ุฌูุฏุง)',

                loginBtn: 'ุงูุชุญ ูุง ุณูุณู ๐',

                forgotPass: 'ูุณูุช ูููุฉ ุงููุฑูุฑุ ุงุถุบุท ููุง',

                contactUs: 'ุชูุงุตู ูุนูุง ๐',

                aboutUs: 'ูุจุฐุฉ ุนูุง โน๏ธ',

                forgotTitle: 'ูุณูุช ุฃู ูุงุฐุงุ ๐ค',

                secQuestionText: 'ุณุคุงู ุงูุฃูุงู: ',

                secAnsPlaceholder: 'ุงูุชุจ ุงูุฅุฌุงุจุฉ ููุง',

                proceed: 'ููุฐูุจ',

                back: 'ุงุฑุฌุน',

                storage: '๐พ ุงูุชุฎุฒูู: ',

                bin: '๐๏ธ ุณูุฉ ุงูููููุงุช ',

                export: '๐ค ุชุตุฏูุฑ ุงูุจูุงูุงุช',

                import: '๐ฅ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช',

                searchPlaceholder: '๐ ูุง ุงูุฐู ุชุจุญุซ ุนููุ',

                allCategories: '๐ ุฌููุน ุงููุฆุงุช',

                booksCat: '๐ ูุชุจ',

                novelsCat: '๐ญ ุฑูุงูุงุช',

                summariesCat: '๐ ููุฎุตุงุช',

                othersCat: 'โจ ุฃุฎุฑู',

                sortNew: '๐ ุงูุฃุญุฏุซ',

                sortAz: '๐ค ูู ุงูุฃูู ุฅูู ุงููุงุก',

                uploadBtn: 'โ ุฑูุน ูุชุงุจ',

                settingsTitle: 'ุงูุฅุนุฏุงุฏุงุช โ๏ธ',

                themeLabel: 'ุงูุซููุงุช:',

                darkTheme: 'ุฏุงูู',

                lightTheme: 'ูุงุชุญ',

                purpleTheme: 'ุจููุณุฌู',

                forestTheme: 'ุบุงุจุฉ',

                sunsetTheme: 'ุบุฑูุจ',

                goldTheme: 'ุฐูุจู',

                languageLabel: 'ุชุบููุฑ ุงููุบุฉ:',

                egyptianArabic: 'ุงูุนุฑุจูุฉ ุงููุตุฑูุฉ',

                standardArabic: 'ุงูุนุฑุจูุฉ ุงููุตุญู',

                english: 'English',

                changePass: 'ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ๐',

                deleteAll: 'ุญุฐู ุงููู ๐๏ธ',

                close: 'ุฅุบูุงู',

                changePassTitle: 'ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ูุณุคุงู ุงูุฃูุงู',

                newPassLabel: 'ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ:',

                newPassPlaceholder: 'ุงูุชุจ ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ',

                newSecQLabel: 'ุณุคุงู ุงูุฃูุงู ุงูุฌุฏูุฏ:',

                newSecQPlaceholder: 'ุณุคุงู ุงูุฃูุงู ุงูุฌุฏูุฏ (ูุซู: ูุง ุทูููุ)',

                newSecALabel: 'ุฅุฌุงุจุฉ ุงูุฃูุงู ุงูุฌุฏูุฏุฉ:',

                newSecAPlaceholder: 'ุฅุฌุงุจุฉ ุงูุฃูุงู ุงูุฌุฏูุฏุฉ',

                saveChanges: 'ุญูุธ ุงูุชุบููุฑุงุช ๐',

                aboutTitle: 'ูุจุฐุฉ ุนูุง',

                aboutDesc: 'ูุฐุง ูููุน ููุชุจุฉ ุฒูุงุฏุ ุงูุฑุงุญุฉ ูููุง 2026 โุ ูุฅุฏุงุฑุฉ ูุชุจู ุงูุฅููุชุฑูููุฉ ุจุฃูุงู ูุณูููุฉ. ููุง ููููู ุฑูุน ูุชุจ PDFุ ุชุตููููุงุ ุงูุจุญุซ ูููุงุ ูุฑุงุกุชูุงุ ูุชูุฒูููุง. ุงูููุชุจุฉ ุดุฎุตูุฉ ุชูุงูุงุ ูุน ูููุฉ ูุฑูุฑ ููุญูุงูุฉุ ูุฎุงุตูุฉ ุชุตุฏูุฑ ูุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช. ููุง ุชุญุชูู ุนูู ุณูุฉ ููููุงุช ูุงุณุชุนุงุฏุฉ ุงููุญุฐููุงุชุ ูุชุบููุฑ ุงูุซููุงุช. ูุตูู ุจุฃุญุฏุซ ุงูุชูููุงุช ููุนูู ุฏูู ุฅูุชุฑูุช ูู PWA. ูู ุตูุน ุฒูุงุฏ ุงูุฏุฑููู.',

                contactTitle: 'ุชูุงุตู ูุนูุง ๐ฌ',

                phoneWhatsapp: 'ุงุชุตุงู/ูุงุชุณุงุจ',

                call: 'ุงุชุตุงู',

                whatsapp: 'ูุงุชุณุงุจ',

                facebook: 'ููุณุจูู',

                visitPage: 'ุฒูุงุฑุฉ ุงูุตูุญุฉ',

                instagram: 'ุฅูุณุชุบุฑุงู',

                instagramBtn: 'ุฅูุณุชุบุฑุงู',

                uploadTitle: 'ุฃุถู ูุง ูุฏูู',

                bookNameLabel: 'ุงุณู ุงููุชุงุจ:',

                bookNamePlaceholder: 'ุงูุชุจ ุงูุงุณู ููุง',

                authorLabel: 'ุงููุคูู:',

                authorPlaceholder: 'ุงุณู ุงููุคูู (ุฅุฐุง ูู ุชุนุฑู ุงูุชุจ \'ุบูุฑ ูุนุฑูู\')',

                categoryLabel: 'ุงููุฆุฉ:',

                ratingLabel: 'ุงูุชูููู:',

                rating5: 'โญโญโญโญโญ ููุชุงุฒ',

                rating4: 'โญโญโญโญ ุฌูุฏ ุฌุฏุง',

                rating3: 'โญโญโญ ุฌูุฏ',

                rating2: 'โญโญ ูุชูุณุท',

                rating1: 'โญ ุถุนูู',

                descLabel: 'ูุตู ูุฎุชุตุฑ:',

                descPlaceholder: 'ุงูุชุจ ูุตูุง ูุฎุชุตุฑุง...',

                confirmUpload: 'ุฃุถู ุงููุชุงุจ ุฅูู ุงูููุชุจุฉ ๐',

                cancel: 'ุฅูุบุงุก',

                editTitle: 'ุชุนุฏูู',

                saveEdit: 'ุญูุธ ุงูุชุนุฏููุงุช ๐พ',

                cancelEdit: 'ุฅูุบุงุก ุงูุชุนุฏูู',

                binTitle: 'ุณูุฉ ุงูููููุงุช ๐๏ธ',

                emptyBin: 'ุญุฐู ุงููู',

                closeBin: 'ุฅุบูุงู',

                chooseLibrary: 'ุงุฎุชุฑ ุงูููุชุจุฉ',

                noorLibrary: 'ููุชุจุฉ ููุฑ',

                kotobatiLibrary: 'ููุชุจุฉ ูุชูุจุงุชู',

                footer: 'ุตูุน ุจุฑุงุญุฉ ุจูุงุณุทุฉ Ziad Library Pro &copy; 2026 โ'

            },

            'en': {

                title: 'Ziad Library - All Chill 2026 โ',

                floatingBadge: 'Ziad the Boss ๐',

                downloadBooks: '๐ Download Books',

                settings: 'โ๏ธ Settings',

                toggleTheme: 'Toggle Mode ๐',

                ziadName: 'Ziad Library VIP',

                welcomeTitle: 'Your Private Library with Password',

                welcomeDesc: 'This is a personal library for managing your e-books securely and easily.',

                createPassword: 'Create Password',

                startNoPassword: 'Start Without Password',

                loginTitle: 'Enter with Your Right Foot, Sir ๐ฆต',

                loginDesc: 'Seems like first time, create a password to protect your books:',

                passwordPlaceholder: 'Password',

                secQuestionPlaceholder: 'Security Question (e.g., How tall are you?)',

                secAnswerPlaceholder: 'Security Answer (Remember it well)',

                loginBtn: 'Open Sesame ๐',

                forgotPass: 'Forgot Password? Click here',

                contactUs: 'Contact Us ๐',

                aboutUs: 'About Us โน๏ธ',

                forgotTitle: 'Forgot or what? ๐ค',

                secQuestionText: 'Security Question: ',

                secAnsPlaceholder: 'Enter the answer here',

                proceed: 'Let\'s Go',

                back: 'Go Back',

                storage: '๐พ Storage: ',

                bin: '๐๏ธ Trash ',

                export: '๐ค Export Data',

                import: '๐ฅ Import Data',

                searchPlaceholder: '๐ What are you looking for?',

                allCategories: '๐ All Categories',

                booksCat: '๐ Books',

                novelsCat: '๐ญ Novels',

                summariesCat: '๐ Summaries',

                othersCat: 'โจ Others',

                sortNew: '๐ Newest',

                sortAz: '๐ค A to Z',

                uploadBtn: 'โ Upload Book',

                settingsTitle: 'Settings โ๏ธ',

                themeLabel: 'Themes:',

                darkTheme: 'Dark',

                lightTheme: 'Light',

                purpleTheme: 'Purple',

                forestTheme: 'Forest',

                sunsetTheme: 'Sunset',

                goldTheme: 'Gold',

                languageLabel: 'Change Language:',

                egyptianArabic: 'Egyptian Arabic',

                standardArabic: 'Standard Arabic',

                english: 'English',

                changePass: 'Change Password ๐',

                deleteAll: 'Delete All ๐๏ธ',

                close: 'Close',

                changePassTitle: 'Change Password and Security Question',

                newPassLabel: 'New Password:',

                newPassPlaceholder: 'Enter new password',

                newSecQLabel: 'New Security Question:',

                newSecQPlaceholder: 'New security question (e.g., How tall are you?)',

                newSecALabel: 'New Security Answer:',

                newSecAPlaceholder: 'New security answer',

                saveChanges: 'Save Changes ๐',

                aboutTitle: 'About Us',

                aboutDesc: 'This is Ziad Library site, all chill 2026 โ, to manage your e-books securely and easily. Upload PDF books, categorize, search, read, and download them. Fully personal with password protection, export/import features. Has trash bin for recovery, theme changes. Designed with latest tech for offline PWA. Made by Ziad Eldreeny.',

                contactTitle: 'Contact Us ๐ฌ',

                phoneWhatsapp: 'Call/WhatsApp',

                call: 'Call',

                whatsapp: 'WhatsApp',

                facebook: 'Facebook',

                visitPage: 'Visit Page',

                instagram: 'Instagram',

                instagramBtn: 'Instagram',

                uploadTitle: 'Add What You Have',

                bookNameLabel: 'Book Name:',

                bookNamePlaceholder: 'Enter name here',

                authorLabel: 'Author:',

                authorPlaceholder: 'Author name (if unknown, write \'Unknown\')',

                categoryLabel: 'Category:',

                ratingLabel: 'Rating:',

                rating5: 'โญโญโญโญโญ Excellent',

                rating4: 'โญโญโญโญ Very Good',

                rating3: 'โญโญโญ Good',

                rating2: 'โญโญ Average',

                rating1: 'โญ Poor',

                descLabel: 'Short Description:',

                descPlaceholder: 'Write a short description...',

                confirmUpload: 'Add Book to Library ๐',

                cancel: 'Cancel',

                editTitle: 'Edit',

                saveEdit: 'Save Edits ๐พ',

                cancelEdit: 'Cancel Edit',

                binTitle: 'Trash Bin ๐๏ธ',

                emptyBin: 'Empty (Delete All)',

                closeBin: 'Close',

                chooseLibrary: 'Choose Library',

                noorLibrary: 'Noor Library',

                kotobatiLibrary: 'Kotobati Library',

                footer: 'Made with Chill by Ziad Library Pro &copy; 2026 โ'

            }

        };

        

        let db;

        let currentPass = localStorage.getItem('ziadPass');

        let secQuestion = localStorage.getItem('ziadSecQuestion');

        let secAnswer = localStorage.getItem('ziadSecAnswer');

        let pendingFile = null;

        

        function init() {

            // Check if browser is Chrome

            const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);

            if (!isChrome) {

                document.body.innerHTML = '<div style="text-align:center; margin-top:50px; color:red;"><h1>Please open in Google Chrome only.</h1><p>ูุฑุฌู ูุชุญ ุงููููุน ูู ูุชุตูุญ ุฌูุฌู ูุฑูู ููุท.</p></div>';

                return;

            }

            const lang = localStorage.getItem('ziadLang') || 'ar-EG';

            document.body.setAttribute('data-lang', lang);

            if (lang === 'en') {

                document.documentElement.lang = 'en';

                document.documentElement.dir = 'ltr';

            } else {

                document.documentElement.lang = 'ar';

                document.documentElement.dir = 'rtl';

            }

            applyTranslations(lang);

            

            const theme = localStorage.getItem('ziadTheme') || 'dark';

            document.body.setAttribute('data-theme', theme);

            const mode = localStorage.getItem('ziadMode');

            if (!mode) {

                showPage('welcomePage');

            } else if (mode === 'noPassword') {

                enterLibrary();

            } else {

                showPage('loginPage');

                checkFirstVisit();

            }

        }

        

        function applyTranslations(lang) {

            document.querySelectorAll('[data-i18n]').forEach(el => {

                const key = el.getAttribute('data-i18n');

                if (translations[lang][key]) {

                    el.innerText = translations[lang][key];

                }

            });

            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {

                const key = el.getAttribute('data-i18n-placeholder');

                if (translations[lang][key]) {

                    el.placeholder = translations[lang][key];

                }

            });

            // Update select options dynamically

            document.querySelectorAll('select option[data-i18n]').forEach(opt => {

                const key = opt.getAttribute('data-i18n');

                if (translations[lang][key]) {

                    opt.innerText = translations[lang][key];

                }

            });

        }

        

        function setLanguage(val) {

            localStorage.setItem('ziadLang', val);

            location.reload(); // Reload to apply changes

        }

        

        function checkFirstVisit() {

            const title = document.getElementById('loginTitle');

            const desc = document.getElementById('loginDesc');

            const btn = document.getElementById('loginBtn');

            const forgot = document.getElementById('forgotPassLink');

            const secSetup = document.getElementById('secSetup');

            if (!currentPass) {

                title.innerText = translations[document.body.getAttribute('data-lang')].loginTitle; // Update based on lang

                desc.style.display = "block";

                btn.innerText = translations[document.body.getAttribute('data-lang')].loginBtn;

                forgot.style.display = "none";

                secSetup.style.display = "block";

            } else {

                secSetup.style.display = "none";

            }

        }

        

        function handleAuth() {

            const inputVal = document.getElementById('passIn').value;

            if (!inputVal) {

                showToast(translations[document.body.getAttribute('data-lang')].errorEmpty);

                return;

            }

            if (!currentPass) {

                const newSecQuestion = document.getElementById('secQuestion').value;

                const newSecAnswer = document.getElementById('secAnswer').value;

                if (!newSecQuestion || !newSecAnswer) {

                    showToast(translations[document.body.getAttribute('data-lang')].errorSec);

                    return;

                }

                localStorage.setItem('ziadPass', inputVal);

                localStorage.setItem('ziadSecQuestion', newSecQuestion);

                localStorage.setItem('ziadSecAnswer', newSecAnswer);

                currentPass = inputVal;

                secQuestion = newSecQuestion;

                secAnswer = newSecAnswer;

                playAudio('success');

                showToast(translations[document.body.getAttribute('data-lang')].welcomeMsg);

                enterLibrary();

            } else {

                if (inputVal === currentPass) {

                    enterLibrary();

                } else {

                    playAudio('error');

                    showToast(translations[document.body.getAttribute('data-lang')].errorWrongPass);

                }

            }

        }

        

        function enterLibrary() {

            playAudio('engine');

            showPage('libraryContent');

            render();

            showToast(translations[document.body.getAttribute('data-lang')].libraryWelcome);

        }

        

        function setTheme(val) {

            localStorage.setItem('ziadTheme', val);

            document.body.setAttribute('data-theme', val);

        }

        

        function toggleTheme() {

            const current = document.body.getAttribute('data-theme');

            const newTheme = current === 'dark' ? 'light' : 'dark';

            setTheme(newTheme);

        }

        

        function openSettings() { playAudio('popup'); document.getElementById('settingsModal').style.display='block'; }

        

        function openDownloadModal() { playAudio('popup'); document.getElementById('downloadModal').style.display='block'; }

        

        function openContactModal() { playAudio('popup'); document.getElementById('contactModal').style.display='block'; }

        

        function openAboutModal() { playAudio('popup'); document.getElementById('aboutModal').style.display='block'; }

        

        function openChangePassModal() { playAudio('popup'); document.getElementById('changePassModal').style.display='block'; }

        

        function saveNewPassAndSec() {

            const np = document.getElementById('newPassInput').value;

            const nsq = document.getElementById('newSecQuestion').value;

            const nsa = document.getElementById('newSecAnswer').value;

            if (np && nsq && nsa) {

                localStorage.setItem('ziadPass', np);

                localStorage.setItem('ziadSecQuestion', nsq);

                localStorage.setItem('ziadSecAnswer', nsa);

                currentPass = np;

                secQuestion = nsq;

                secAnswer = nsa;

                showToast(translations[document.body.getAttribute('data-lang')].passChanged);

                closeModals();

            } else {

                showToast(translations[document.body.getAttribute('data-lang')].errorFillAll);

            }

        }

        

        function deleteAllBooks() {

            if (confirm(translations[document.body.getAttribute('data-lang')].confirmDeleteAll)) {

                const tx = db.transaction("books", "readwrite");

                tx.objectStore("books").clear().onsuccess = () => {

                    render();

                    updateStats();

                    showToast(translations[document.body.getAttribute('data-lang')].allDeleted);

                };

            }

        }

        

        const req = indexedDB.open("Ziad_Library_Pro_2026", 2);

        req.onupgradeneeded = (e) => {

            const d = e.target.result;

            if(!d.objectStoreNames.contains("books")) d.createObjectStore("books", {keyPath: "id", autoIncrement: true});

            if(!d.objectStoreNames.contains("bin")) d.createObjectStore("bin", {keyPath: "id", autoIncrement: true});

        };

        req.onsuccess = (e) => { 

            db = e.target.result; 

            updateStats();

            setTimeout(() => document.getElementById('loader').style.display='none', 800);

        };

        

        function showToast(m) {

            const t = document.getElementById('toast'); t.innerText = m;

            t.style.display = 'block'; setTimeout(() => t.style.display = 'none', 3000);

        }

        

        function showPage(id) {

            ['welcomePage', 'loginPage', 'secPage', 'libraryContent'].forEach(p => document.getElementById(p).style.display = 'none');

            document.getElementById(id).style.display = 'block';

            const sBtn = document.getElementById('settingsBtn');

            const dBtn = document.getElementById('downloadBtn');

            const tToggle = document.getElementById('themeToggle');

            const fBadge = document.getElementById('floatingBadge');

            if (id === 'libraryContent') { sBtn.style.display = 'block'; dBtn.style.display = 'block'; tToggle.style.display = 'block'; fBadge.style.display = 'block'; }

            else { sBtn.style.display = 'none'; dBtn.style.display = 'none'; tToggle.style.display = 'none'; fBadge.style.display = 'none'; }

            if (id === 'secPage') {

                document.getElementById('secQuestionText').innerText = translations[document.body.getAttribute('data-lang')].secQuestionText + (secQuestion || translations[document.body.getAttribute('data-lang')].defaultSecQ);

            }

        }

        

        function checkSec() {

            const inputAnswer = document.getElementById('secAns').value;

            if(inputAnswer === secAnswer) {

                playAudio('engine');

                showPage('libraryContent'); 

                showToast(translations[document.body.getAttribute('data-lang')].secSuccess); 

                render();

            } else {

                playAudio('error');

                showToast(translations[document.body.getAttribute('data-lang')].secError);

            }

        }

        

        function closeModals() { 

            document.querySelectorAll('.modal').forEach(m => m.style.display='none'); 

        }

        

        function upload(e) {

            pendingFile = e.target.files[0];

            if(!pendingFile) return;

            playAudio('popup');

            document.getElementById('pendingFileName').innerText = pendingFile.name;

            document.getElementById('bookNameInput').value = pendingFile.name.replace('.pdf','');

            document.getElementById('uploadModal').style.display = 'block';

        }

        

        document.getElementById('confirmUploadBtn').onclick = async () => {

            const name = document.getElementById('bookNameInput').value;

            const author = document.getElementById('authorInput').value || translations[document.body.getAttribute('data-lang')].defaultAuthor;

            const cat = document.getElementById('selectedCat').value;

            const desc = document.getElementById('bookDescInput').value || translations[document.body.getAttribute('data-lang')].defaultDesc;

            const rating = document.getElementById('bookRatingInput').value;

            const file = pendingFile;

            

            closeModals();

            showToast(translations[document.body.getAttribute('data-lang')].uploading);

            

            const r = new FileReader();

            r.onload = async (ev) => {

                const pdfData = ev.target.result;

                const pdfInfo = await getPdfInfo(pdfData);

                

                const tx = db.transaction("books", "readwrite");

                tx.objectStore("books").add({ 

                    name: name, author: author, data: pdfData, thumb: pdfInfo.thumb, 

                    pages: pdfInfo.pages, size: file.size, category: cat,

                    description: desc, rating: rating, date: new Date().toLocaleDateString('ar-EG') 

                });

                tx.oncomplete = () => { 

                    playAudio('success'); render(); updateStats(); showToast(translations[document.body.getAttribute('data-lang')].uploadSuccess); 

                    document.getElementById('bookDescInput').value = ''; document.getElementById('authorInput').value = '';

                };

            };

            r.readAsDataURL(file);

        };

        

        async function getPdfInfo(data) {

            try {

                const pdf = await pdfjsLib.getDocument(data).promise;

                const page = await pdf.getPage(1);

                const canv = document.createElement('canvas');

                const view = page.getViewport({scale: 0.3});

                canv.width = view.width; canv.height = view.height;

                await page.render({canvasContext: canv.getContext('2d'), viewport: view}).promise;

                return { thumb: canv.toDataURL('image/jpeg', 0.6), pages: pdf.numPages };

            } catch { return { thumb: '', pages: 0 }; }

        }

        

        function render() {

            const g = document.getElementById('grid');

            const q = document.getElementById('search').value.toLowerCase();

            const s = document.getElementById('sort').value;

            const cf = document.getElementById('catFilter').value;

            g.innerHTML = "";

            

            const tx = db.transaction("books", "readonly");

            let books = [];

            tx.objectStore("books").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) { 

                    const v = c.value;

                    if((v.name.toLowerCase().includes(q) || (v.author && v.author.toLowerCase().includes(q))) && (cf === 'all' || v.category === cf)) books.push(v); 

                    c.continue(); 

                } else {

                    books.sort((a,b) => s === 'az' ? a.name.localeCompare(b.name) : b.id - a.id);

                    books.forEach(b => {

                        const d = document.createElement('div'); d.className = 'card';

                        d.innerHTML = `

                            <div class="card-tag">${b.category || translations[document.body.getAttribute('data-lang')].defaultCat}</div>

                            <img src="${b.thumb || 'https://via.placeholder.com/150'}" class="preview" onclick="openPdf(${b.id})">

                            <div class="book-title">${b.name}</div>

                            <div class="book-author">๐ค ${b.author || translations[document.body.getAttribute('data-lang')].defaultAuthor}</div>

                            <div class="book-rating">${"โญ".repeat(b.rating || 5)}</div>

                            <div class="book-meta">${b.pages ? b.pages+' ' + translations[document.body.getAttribute('data-lang')].pages : ''} | ${formatSize(b.size)}</div>

                            <div class="card-btns">

                                <button class="btn-s" style="background:var(--primary); color:#000" onclick="openPdf(${b.id})" data-i18n="read">ูุฑุงุกุฉ ๐</button>

                                <button class="btn-s" style="background:#333" onclick="downB(${b.id})" data-i18n="download">ุญูู ๐</button>

                                <button class="btn-s btn-edit" onclick="openEdit(${b.id})" data-i18n="edit">ุธุจุทู โ๏ธ</button>

                                <button class="btn-s" style="background:var(--danger)" onclick="moveToBin(${b.id})" data-i18n="delete">ุงุฑููู ๐๏ธ</button>

                            </div>`;

                        g.appendChild(d);

                    });

                    applyTranslations(document.body.getAttribute('data-lang')); // Re-apply for dynamic content

                }

            };

        }

        

        function openPdf(id) {

            db.transaction("books").objectStore("books").get(id).onsuccess = (e) => {

                const b = e.target.result;

                window.open(b.data, '_blank');

            };

        }

        

        function openEdit(id) {

            db.transaction("books").objectStore("books").get(id).onsuccess = (e) => {

                const b = e.target.result;

                document.getElementById('editBookId').value = b.id;

                document.getElementById('editName').value = b.name;

                document.getElementById('editAuthor').value = b.author || '';

                document.getElementById('editCat').value = b.category;

                document.getElementById('editDesc').value = b.description || '';

                document.getElementById('editModal').style.display = 'block';

            };

        }

        

        function saveEdit() {

            const id = Number(document.getElementById('editBookId').value);

            const tx = db.transaction("books", "readwrite");

            const store = tx.objectStore("books");

            store.get(id).onsuccess = (e) => {

                const data = e.target.result;

                data.name = document.getElementById('editName').value;

                data.author = document.getElementById('editAuthor').value;

                data.category = document.getElementById('editCat').value;

                data.description = document.getElementById('editDesc').value;

                store.put(data);

                tx.oncomplete = () => { playAudio('success'); closeModals(); render(); showToast(translations[document.body.getAttribute('data-lang')].editSaved); };

            };

        }

        

        function downB(id) {

            playAudio('click');

            showToast(translations[document.body.getAttribute('data-lang')].downloading);

            db.transaction("books").objectStore("books").get(id).onsuccess = (e) => {

                const b = e.target.result;

                const a = document.createElement('a'); a.href = b.data; a.download = b.name + ".pdf"; a.click();

            };

        }

        

        function moveToBin(id) {

            playAudio('trash');

            const tx = db.transaction(["books", "bin"], "readwrite");

            tx.objectStore("books").get(id).onsuccess = (e) => {

                tx.objectStore("bin").add(e.target.result);

                tx.objectStore("books").delete(id);

                tx.oncomplete = () => { render(); updateStats(); showToast(translations[document.body.getAttribute('data-lang')].movedToBin); };

            };

        }

        

        function showBin() {

            const list = document.getElementById('binList'); list.innerHTML = "";

            document.getElementById('binModal').style.display = 'block';

            db.transaction("bin").objectStore("bin").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) {

                    const row = document.createElement('div'); row.style = "display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #333; align-items:center";

                    row.innerHTML = `<span style="font-size:0.9rem">${c.value.name}</span> <button class="btn-s" style="background:#198754; padding:5px 10px" onclick="restoreBook(${c.value.id})" data-i18n="restore">${translations[document.body.getAttribute('data-lang')].restore}</button>`;

                    list.appendChild(row); c.continue();

                }

            };

        }

        

        function restoreBook(id) {

            playAudio('success');

            const tx = db.transaction(["books", "bin"], "readwrite");

            tx.objectStore("bin").get(id).onsuccess = (e) => {

                tx.objectStore("books").add(e.target.result);

                tx.objectStore("bin").delete(id);

                tx.oncomplete = () => { showBin(); render(); updateStats(); showToast(translations[document.body.getAttribute('data-lang')].restored); };

            };

        }

        

        function emptyBin() {

            if(confirm(translations[document.body.getAttribute('data-lang')].confirmEmptyBin)) {

                playAudio('trash');

                db.transaction("bin", "readwrite").objectStore("bin").clear().onsuccess = () => {

                    closeModals(); updateStats(); showToast(translations[document.body.getAttribute('data-lang')].binEmptied);

                };

            }

        }

        

        function updateStats() {

            let total = 0;

            const tx = db.transaction(["books", "bin"], "readonly");

            tx.objectStore("books").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) { total += (c.value.size || 0); c.continue(); }

                else document.getElementById('totalStorage').innerText = formatSize(total);

            };

            tx.objectStore("bin").count().onsuccess = (e) => document.getElementById('binCount').innerText = e.target.result;

        }

        

        function formatSize(bytes) {

            if(!bytes) return '0 B';

            const i = Math.floor(Math.log(bytes) / Math.log(1024));

            return (bytes / Math.pow(1024, i)).toFixed(1) + ' ' + ['B', 'KB', 'MB', 'GB'][i];

        }

        

        function exportData() {

            const tx = db.transaction("books", "readonly");

            const data = [];

            tx.objectStore("books").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) { data.push(c.value); c.continue(); }

                else {

                    const a = document.createElement('a');

                    a.href = URL.createObjectURL(new Blob([JSON.stringify(data)], {type: "application/json"}));

                    a.download = "Ziad_Library_Backup.json"; a.click();

                }

            };

        }

        

        function importData(e) {

            const reader = new FileReader();

            reader.onload = (ev) => {

                const data = JSON.parse(ev.target.result);

                const tx = db.transaction("books", "readwrite");

                data.forEach(item => tx.objectStore("books").add(item));

                tx.oncomplete = () => { playAudio('success'); render(); updateStats(); showToast(translations[document.body.getAttribute('data-lang')].importSuccess); };

            };

            reader.readAsText(e.target.files[0]);

        }

        

        function choosePasswordMode() {

            localStorage.setItem('ziadMode', 'password');

            showPage('loginPage');

            checkFirstVisit();

        }

        

        function chooseNoPasswordMode() {

            localStorage.setItem('ziadMode', 'noPassword');

            enterLibrary();

        }

        

        // Add default translations for toasts and errors

        const lang = localStorage.getItem('ziadLang') || 'ar-EG';

        translations[lang].errorEmpty = lang === 'ar-EG' ? "โ๏ธ ุงูุชุจ ุฃู ุญุงุฌุฉ ูุง ุนู!" : lang === 'ar' ? "โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ูููุฉ!" : "โ๏ธ Please enter something!";

        translations[lang].errorSec = lang === 'ar-EG' ? "โ๏ธ ูุงุฒู ุชูุชุจ ุณุคุงู ุฃูุงู ูุฅุฌุงุจุชู ูุง ูุนูู!" : lang === 'ar' ? "โ๏ธ ูุฌุจ ูุชุงุจุฉ ุณุคุงู ุฃูุงู ูุฅุฌุงุจุชู!" : "โ๏ธ Must enter security question and answer!";

        translations[lang].welcomeMsg = lang === 'ar-EG' ? "โ ุฃููุง ุจูู ูุง ุฑูุณ ูู ููุชุจุชู" : lang === 'ar' ? "โ ูุฑุญุจุง ุจู ูู ููุชุจุชู" : "โ Welcome to your library";

        translations[lang].errorWrongPass = lang === 'ar-EG' ? "โ ุบูุท ูุง ุฒูููู! ุฑูุฒ ุดููุฉ ๐" : lang === 'ar' ? "โ ุฎุทุฃ! ุญุงูู ูุฑุฉ ุฃุฎุฑู" : "โ Wrong! Try again";

        translations[lang].libraryWelcome = lang === 'ar-EG' ? "ููุฑุช ุงูููุชุจุฉ ูุง ููุฏุณุฉ ๐ก" : lang === 'ar' ? "ูุฑุญุจุง ูู ุงูููุชุจุฉ" : "Welcome to the library";

        translations[lang].passChanged = lang === 'ar-EG' ? "โ ุบูุฑูุง ูููุฉ ุงูุณุฑ ูุณุคุงู ุงูุฃูุงูุ ุงูุนู ุชูุณุงูู ุจูู!" : lang === 'ar' ? "โ ุชู ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ูุณุคุงู ุงูุฃูุงู" : "โ Password and security changed";

        translations[lang].errorFillAll = lang === 'ar-EG' ? "โ๏ธ ูุงุฒู ุชููุฃ ูู ุงูุญููู ูุง ูุนูู!" : lang === 'ar' ? "โ๏ธ ูุฌุจ ููุก ุฌููุน ุงูุญููู!" : "โ๏ธ Fill all fields!";

        translations[lang].confirmDeleteAll = lang === 'ar-EG' ? "ูุชุญุฐู ูู ุงููุชุจ ุจุฌุฏุ ูููุด ุฑุฌุนุฉ ูุง ุฑูุณ! ๐ฑ" : lang === 'ar' ? "ูู ุชุฑูุฏ ุญุฐู ุฌููุน ุงููุชุจุ ูุง ุฑุฌุนุฉ!" : "Delete all books? No return!";

        translations[lang].allDeleted = lang === 'ar-EG' ? "๐๏ธ ุจุญ.. ูู ุงููุชุจ ุฑุงุญุช!" : lang === 'ar' ? "๐๏ธ ุชู ุญุฐู ุฌููุน ุงููุชุจ" : "๐๏ธ All books deleted";

        translations[lang].secSuccess = lang === 'ar-EG' ? "ุฃููู ูุฏุฉ ูุง ูุฏูุน! ููุฑุช ๐" : lang === 'ar' ? "ุตุญูุญ! ูุฑุญุจุง" : "Correct! Welcome";

        translations[lang].secError = lang === 'ar-EG' ? "โ๏ธ ุจุชูุชู ูููุ ุบูุท!" : lang === 'ar' ? "โ๏ธ ุฎุทุฃ!" : "โ๏ธ Wrong!";

        translations[lang].uploading = lang === 'ar-EG' ? "โณ ุงุตุจุฑ ุดููุฉ ุจูุญูู ุงููุชุงุจ..." : lang === 'ar' ? "โณ ุฌุงุฑู ุงูุชุญููู..." : "โณ Uploading...";

        translations[lang].uploadSuccess = lang === 'ar-EG' ? "โ ุงููุชุงุจ ูุตู ุจุงูุณูุงูุฉ!" : lang === 'ar' ? "โ ุชู ุฅุถุงูุฉ ุงููุชุงุจ" : "โ Book added";

        translations[lang].defaultAuthor = lang === 'ar-EG' ? "ูุงุนู ุฎูุฑ" : lang === 'ar' ? "ุบูุฑ ูุนุฑูู" : "Unknown";

        translations[lang].defaultDesc = lang === 'ar-EG' ? "ูู ุบูุฑ ูุตู" : lang === 'ar' ? "ุจุฏูู ูุตู" : "No description";

        translations[lang].defaultCat = lang === 'ar-EG' ? "ูููุชูู" : lang === 'ar' ? "ุฃุฎุฑู" : "Others";

        translations[lang].pages = lang === 'ar-EG' ? "ูุฑูุฉ" : lang === 'ar' ? "ุตูุญุฉ" : "pages";

        translations[lang].read = lang === 'ar-EG' ? "ูุฑุงุกุฉ ๐" : lang === 'ar' ? "ูุฑุงุกุฉ ๐" : "Read ๐";

        translations[lang].download = lang === 'ar-EG' ? "ุญูู ๐" : lang === 'ar' ? "ุชูุฒูู ๐" : "Download ๐";

        translations[lang].edit = lang === 'ar-EG' ? "ุธุจุทู โ๏ธ" : lang === 'ar' ? "ุชุนุฏูู โ๏ธ" : "Edit โ๏ธ";

        translations[lang].delete = lang === 'ar-EG' ? "ุงุฑููู ๐๏ธ" : lang === 'ar' ? "ุญุฐู ๐๏ธ" : "Delete ๐๏ธ";

        translations[lang].downloading = lang === 'ar-EG' ? "ุฌุงุฑู ุงูุชุญููู... ุงุณุชููุงู ๐ฅ" : lang === 'ar' ? "ุฌุงุฑู ุงูุชูุฒูู ๐ฅ" : "Downloading ๐ฅ";

        translations[lang].movedToBin = lang === 'ar-EG' ? "๐๏ธ ุทูุฑูุงู ูู ุงูุฒุจุงูุฉ" : lang === 'ar' ? "๐๏ธ ููู ุฅูู ุงูููููุงุช" : "๐๏ธ Moved to trash";

        translations[lang].restore = lang === 'ar-EG' ? "ุฑุฌุนู ุชุงูู" : lang === 'ar' ? "ุงุณุชุนุงุฏุฉ" : "Restore";

        translations[lang].restored = lang === 'ar-EG' ? "ุฑุฌุนูุงู ูููุฑ ุงูููุชุจุฉ โจ" : lang === 'ar' ? "ุชู ุงูุงุณุชุนุงุฏุฉ โจ" : "Restored โจ";

        translations[lang].confirmEmptyBin = lang === 'ar-EG' ? "ูุชูุฑู ุงููุชุจ ุฏู ุจุฌุฏุ ูููุด ุฑุฌุนุฉ ูุง ูุนูู! ๐ฑ" : lang === 'ar' ? "ูู ุชุฑูุฏ ุญุฐู ุงููู ููุงุฆูุงุ" : "Delete all permanently?";

        translations[lang].binEmptied = lang === 'ar-EG' ? "ุจุญ.. ุงูุฒุจุงูุฉ ูุถูุช ๐งน" : lang === 'ar' ? "ุชู ุชูุฑูุบ ุงูููููุงุช ๐งน" : "Trash emptied ๐งน";

        translations[lang].editSaved = lang === 'ar-EG' ? "โ ุนุฏููุง ูููู ุชูุงู ูุง ุจุฑูุณ" : lang === 'ar' ? "โ ุชู ุญูุธ ุงูุชุนุฏููุงุช" : "โ Edits saved";

        translations[lang].importSuccess = lang === 'ar-EG' ? "โ ุฑุฌุนูุง ุงููุชุจ ูุง ูุญุด" : lang === 'ar' ? "โ ุชู ุงุณุชูุฑุงุฏ ุงููุชุจ" : "โ Books imported";

        translations[lang].defaultSecQ = lang === 'ar-EG' ? "ุทููู ูุงู ูุง ุนู ุงูุทูููุ" : lang === 'ar' ? "ูุง ุทููู ุฃููุง ุงูุทูููุ" : "How tall are you?";

        

        init();

    </script>

</body>

</html>