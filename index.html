<!DOCTYPE html>

<html lang="ar" dir="rtl">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Ù…ÙƒØªØ¨Ø© Ziad Aldriny 2026 - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>

    

    <link rel="icon" type="image/png" href="favicon.png">

    

    <meta property="og:title" content="Ù…ÙƒØªØ¨Ø© Ziad Aldriny 2026">

    <meta property="og:description" content="Ù…ÙƒØªØ¨ØªÙŠ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª">

    <meta property="og:image" content="social-preview.png">

    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary_large_image">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;600;900&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>

    

    <style>

        :root {

            --primary: #00d4ff; --bg: #050505; --card: #0d1117;

            --text: #ffffff; --border: rgba(255,255,255,0.1); --danger: #ff4d4d;

            --success: #2ecc71;

        }

        [data-theme="light"] { --bg: #f0f2f5; --card: #ffffff; --text: #1a1a1a; --primary: #007bff; --border: rgba(0,0,0,0.1); }

        [data-theme="purple"] { --bg: #1a0b2e; --card: #2d1454; --text: #ffffff; --primary: #bc13fe; --border: rgba(255,255,255,0.1); }

        [data-theme="forest"] { --bg: #0a1a0a; --card: #142d14; --text: #ffffff; --primary: #2ecc71; --border: rgba(255,255,255,0.1); }

        [data-theme="sunset"] { --bg: #1a0f0f; --card: #2d1414; --text: #ffffff; --primary: #e67e22; --border: rgba(255,255,255,0.1); }

        [data-theme="gold"] { --bg: #11110a; --card: #222214; --text: #ffffff; --primary: #f1c40f; --border: rgba(255,255,255,0.1); }

        * { box-sizing: border-box; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; min-height: 100vh; overflow-x: hidden; }

        .floating-badge {

            position: fixed; bottom: 20px; right: 20px;

            background: rgba(255, 255, 255, 0.1);

            backdrop-filter: blur(10px);

            border: 1px solid var(--primary);

            color: var(--primary);

            padding: 10px 20px;

            border-radius: 50px;

            font-weight: 900;

            font-size: 1.1rem;

            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);

            z-index: 9999;

            animation: pulse 2s infinite, float 3s ease-in-out infinite;

            display: none;

        }

        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(0,212,255,0.4); } 70% { box-shadow: 0 0 0 15px rgba(0,212,255,0); } 100% { box-shadow: 0 0 0 0 rgba(0,212,255,0); } }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        #loader { position: fixed; inset: 0; background: linear-gradient(135deg, #000000, #001f3f); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10000; opacity: 1; transition: opacity 1s ease-out; }

        #loader.fade-out { opacity: 0; }

        .loader-icon-container { position: relative; animation: fadeInUp 1s ease-out; }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .loader-logo { width: 220px; height: 220px; border-radius: 30px; border: 3px solid var(--primary); box-shadow: 0 0 30px var(--primary), 0 0 60px rgba(0, 212, 255, 0.5); object-fit: cover; animation: pulseGlow 2s infinite; }

        @keyframes pulseGlow { 0% { box-shadow: 0 0 30px var(--primary), 0 0 60px rgba(0, 212, 255, 0.5); } 50% { box-shadow: 0 0 50px var(--primary), 0 0 80px rgba(0, 212, 255, 0.7); } 100% { box-shadow: 0 0 30px var(--primary), 0 0 60px rgba(0, 212, 255, 0.5); } }

        .loader-badge { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2.5rem; font-weight: 900; color: var(--primary); text-shadow: 0 0 15px var(--primary), 0 0 30px rgba(0, 212, 255, 0.7); animation: scalePulse 1.5s infinite; }

        @keyframes scalePulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.1); } }

        .loader-title { font-size: 3rem; font-weight: 900; text-shadow: 0 0 20px var(--primary), 0 0 40px rgba(0, 212, 255, 0.5); margin: 30px 0 10px; letter-spacing: 2px; animation: fadeInUp 1s ease-out 0.5s forwards; opacity: 0; }

        .loader-subtitle { font-size: 1rem; font-style: italic; color: #ccc; text-shadow: 0 0 10px rgba(255,255,255,0.5); font-family: 'Cairo'; opacity: 0; animation: fadeInUp 1s ease-out 1s forwards; }

        .header { text-align: center; padding: 30px 0; position: relative; }

        #sidebarToggle { position: absolute; top: 15px; left: 15px; z-index: 100; font-size: 1.5rem; background: none; border: none; color: var(--primary); cursor: pointer; display: none; }

        .user-logo { width: 100px; height: 100px; border-radius: 20px; border: 2px solid var(--primary); box-shadow: 0 0 20px var(--primary); object-fit: cover; }

        .ziad-name { font-size: 2rem; font-weight: 900; text-shadow: 0 0 15px var(--primary); margin: 10px 0; }

        

        .glass-panel { background: rgba(255,255,255,0.03); backdrop-filter: blur(15px); border: 1px solid var(--border); border-radius: 25px; padding: 35px; width: 90%; max-width: 400px; margin: 40px auto; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        input, select { width: 100%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: var(--text); text-align: center; font-family: 'Cairo'; outline: none; }

        input:focus { border-color: var(--primary); box-shadow: 0 0 10px var(--primary); }

        

        .btn { background: linear-gradient(45deg, #0056b3, var(--primary)); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: 700; cursor: pointer; width: 100%; font-size: 1rem; }

        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px var(--primary); }

        

        #libraryContent { display: none; padding: 20px; max-width: 1300px; margin: auto; animation: fadeIn 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .top-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; gap: 15px; flex-wrap: wrap; }

        .status-chip { background: var(--card); padding: 8px 16px; border-radius: 50px; border: 1px solid var(--primary); cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; gap: 8px; font-weight: bold; }

        .status-chip:hover { background: var(--primary); color: #000; }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; z-index: 2000; padding: 20px; backdrop-filter: blur(5px); }

        .modal-box { background: var(--card); max-width: 450px; margin: 50px auto; padding: 25px; border-radius: 25px; border: 1px solid var(--primary); }

        

        .controls { display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 12px; background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 30px; border: 1px solid var(--border); }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }

        

        .card { background: var(--card); border-radius: 20px; padding: 12px; border: 1px solid var(--border); position: relative; overflow: hidden; display: flex; flex-direction: column; }

        .card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }

        .card-tag { position: absolute; top: 12px; right: 12px; background: var(--primary); color: #000; font-size: 0.7rem; padding: 4px 10px; border-radius: 8px; font-weight: 900; z-index: 5; }

        .preview { width: 100%; aspect-ratio: 3/4; border-radius: 12px; object-fit: cover; background: #111; cursor: pointer; }

        

        .title-edit { font-weight: 700; background: transparent; border: none; color: var(--primary); width: 100%; text-align: center; font-size: 1rem; margin: 12px 0 5px 0; }

        .book-meta { font-size: 0.75rem; color: #888; margin-bottom: 12px; text-align: center; }

        .card-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: auto; }

        .btn-s { padding: 10px; border-radius: 8px; border: none; font-weight: bold; font-size: 0.8rem; cursor: pointer; color: #fff; }

        

        .book-rating { color: #f1c40f; font-size: 0.9rem; margin-bottom: 5px; text-align: center; }

        .book-description { font-size: 0.8rem; color: #bbb; text-align: center; margin-bottom: 10px; height: 2.4em; overflow: hidden; }

        #toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: var(--primary); color: #000; padding: 12px 30px; border-radius: 15px; font-weight: 800; display: none; z-index: 5000; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

        

        @media (max-width: 600px) {

            .grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }

            .controls { grid-template-columns: 1fr; }

        }

        .footer { text-align: center; padding: 40px; color: #666; font-size: 0.9rem; font-weight: bold; }

        /* Sidebar Styles */

        #sidebar {

            position: fixed; top: 0; left: 0; width: 250px; height: 100%; background: var(--card); 

            transform: translateX(-100%); transition: transform 0.3s ease; z-index: 1001;

            padding: 20px; border-right: 1px solid var(--border);

        }

        #sidebar.open { transform: translateX(0); }

        .sidebar-item { display: block; padding: 15px; border-bottom: 1px solid var(--border); cursor: pointer; }

        .sidebar-item:hover { background: var(--primary); color: #000; }

        /* Contact Icons Styles */

        .contact-btn { display: flex; align-items: center; justify-content: center; gap: 10px; background: linear-gradient(45deg, #0056b3, var(--primary)); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: 700; cursor: pointer; width: 100%; font-size: 1rem; margin-top: 10px; }

        .contact-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px var(--primary); }

        .contact-icon { font-size: 1.5rem; }

    </style>

    <style>
/* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø´ØºÙ„ - ØªØµÙ…ÙŠÙ… Ù…ÙˆØ¯Ø±Ù† 2026 */
:root {
    --reader-bg: #0f0f0f;
    --toolbar-bg: rgba(20, 20, 20, 0.8);
    --accent: #ff0055; /* ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ Ù„Ù„ÙˆÙ†Ùƒ Ø§Ù„Ù…ÙØ¶Ù„ */
    --text: #ffffff;
}

.ziad-reader-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: var(--reader-bg); z-index: 10000; font-family: 'Cairo', sans-serif;
}

.reader-container { height: 100%; display: flex; flex-direction: column; position: relative; }

.reader-toolbar {
    display: flex; justify-content: space-between; align-items: center;
    padding: 10px 20px; background: var(--toolbar-bg); backdrop-filter: blur(15px);
    border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 10;
}

.t-section { display: flex; align-items: center; gap: 12px; }
.t-btn { 
    background: rgba(255,255,255,0.05); border: none; color: white; 
    width: 38px; height: 38px; border-radius: 10px; cursor: pointer;
    transition: 0.3s; display: flex; align-items: center; justify-content: center;
}
.t-btn:hover { background: var(--accent); transform: translateY(-2px); }
.close-btn { background: rgba(255, 0, 0, 0.2); }

.page-info { background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 20px; font-weight: bold; border: 1px solid rgba(255,255,255,0.1); }
.page-info input { width: 40px; background: transparent; border: none; color: var(--accent); text-align: center; font-size: 1rem; outline: none; }

#viewer-viewport { flex: 1; overflow: auto; display: flex; justify-content: center; padding: 40px 10px; background: #1a1a1a; transition: 0.4s; }
#canvas-wrapper { box-shadow: 0 20px 50px rgba(0,0,0,0.6); transition: transform 0.3s ease; }

.floating-actions {
    position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
    background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); padding: 10px 25px;
    border-radius: 50px; display: flex; gap: 20px; border: 1px solid rgba(255,255,255,0.1);
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); opacity: 0.5; transition: 0.3s;
}
.floating-actions:hover { opacity: 1; bottom: 35px; }
.f-btn { background: transparent; border: none; color: #ddd; cursor: pointer; font-size: 0.9rem; font-family: 'Cairo'; }
.f-btn:hover { color: var(--accent); }

.v-sep { width: 1px; height: 20px; background: rgba(255,255,255,0.2); }

/* Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© */
.mode-sepia { background: #f4ecd8 !important; }
.mode-sepia canvas { filter: sepia(0.6) contrast(1.1); }
.mode-dark { background: #000 !important; }
.mode-dark canvas { filter: invert(0.9) hue-rotate(180deg); }

.custom-scroll::-webkit-scrollbar { width: 8px; }
.custom-scroll::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }
</style>

</head>

<body data-theme="dark">

    <div id="loader">
        <div class="loader-icon-container">
            <img src="favicon.png" class="loader-logo" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1043/1043322.png'">
            <div class="loader-badge">#1</div>
        </div>
        <h1 class="loader-title">Ziad Library</h1>
        <p class="loader-subtitle">Made In Aldriny</p>
    </div>

    <div class="floating-badge" id="floatingBadge">Ziad # 1</div>

    

    <div class="header">

        <button id="sidebarToggle">â˜°</button>

        <img src="favicon.png" class="user-logo" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1043/1043322.png'">

        <div class="ziad-name">Ziad Library</div>

    </div>

    <div id="sidebar">

        <div class="sidebar-item" id="settingsBtn" onclick="playAudio('click'); openSettings()">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>

        <div class="sidebar-item" onclick="playAudio('click'); openContact()">ğŸ“ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</div>

        <div class="sidebar-item" onclick="playAudio('click'); openDownloadBooks()">ğŸ“š ØªÙ†Ø²ÙŠÙ„ ÙƒØªØ¨</div>

        <div class="sidebar-item" onclick="playAudio('click'); openAboutUs()">â„¹ï¸ Ù„Ù…Ø­Ø© Ø¹Ù†Ø§</div>

    </div>

    <div id="loginPage" class="glass-panel">

        <h2 style="color:var(--primary); margin-top:0">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¨Ø·Ù„ ğŸŒ€</h2>

        <input type="password" id="passIn" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

        <button class="btn" onclick="login()">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ÙƒØªØ¨Ø©</button>

        <p onclick="playAudio('click'); showPage('secPage')" style="cursor:pointer; font-size:0.8rem; margin-top:20px; color:#555">Ù‡Ù„ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</p>

    </div>

    <div id="secPage" class="glass-panel" style="display:none">

        <h3 style="color:var(--primary)">ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ø§Ù†</h3>

        <p style="font-size:0.9rem">Ù…Ø§ Ù‡Ùˆ Ø·ÙˆÙ„ÙƒØŸ</p>

        <input type="text" id="secAns" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù‡Ù†Ø§">

        <button class="btn" onclick="checkSec()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù‡ÙˆÙŠØ©</button>

        <button class="btn" style="background:transparent; color:#777; margin-top:10px" onclick="playAudio('click'); showPage('loginPage')">Ø±Ø¬ÙˆØ¹</button>

    </div>

    <div id="libraryContent">

        <div class="top-nav">

            <div style="display:flex; gap:10px">

                <div class="status-chip" onclick="playAudio('popup');" id="storageChip">ğŸ’¾ Ø§Ù„Ù…Ø³Ø§Ø­Ø©: <span id="totalStorage">0 KB</span></div>

                <div class="status-chip" onclick="playAudio('trash'); showBin()" style="border-color:var(--danger); color:var(--danger)">ğŸ—‘ï¸ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª (<span id="binCount">0</span>)</div>

            </div>

            <div style="display:flex; gap:10px">

                <button class="status-chip" style="background:#198754; color:#fff; border:none" onclick="playAudio('success'); exportData()">ğŸ“¤ ØªØµØ¯ÙŠØ± Ù†Ø³Ø®Ø©</button>

                <button class="status-chip" style="background:#6f42c1; color:#fff; border:none" onclick="playAudio('click'); document.getElementById('importFile').click()">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù†Ø³Ø®Ø©</button>

                <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">

            </div>

        </div>

        <div class="controls">

            <input type="text" id="search" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨ Ø£Ùˆ Ø§Ù„ÙˆØµÙ..." oninput="render()">

            <select id="catFilter" onchange="playAudio('click'); render()">

                <option value="all">ğŸ“ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>

                <option value="ÙƒØªØ¨">ğŸ“š ÙƒØªØ¨</option>

                <option value="Ø±ÙˆØ§ÙŠØ§Øª">ğŸ­ Ø±ÙˆØ§ÙŠØ§Øª</option>

                <option value="Ù…Ù„Ø®ØµØ§Øª">ğŸ“ Ù…Ù„Ø®ØµØ§Øª</option>

                <option value="Ø£Ø®Ø±Ù‰">âœ¨ Ø£Ø®Ø±Ù‰</option>

            </select>

            <select id="sort" onchange="playAudio('click'); render()">

                <option value="new">ğŸ•’ Ø§Ù„Ø£Ø­Ø¯Ø«</option>

                <option value="az">ğŸ”¤ Ø£Ø¨Ø¬Ø¯ÙŠ</option>

            </select>

            <button class="btn" onclick="playAudio('popup'); document.getElementById('fileIn').click()">â• Ø±ÙØ¹ PDF</button>

            <input type="file" id="fileIn" accept=".pdf" style="display:none" onchange="upload(event)">

        </div>

        <div class="grid" id="grid"></div>

    </div>

    <div id="settingsModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âš™ï¸</h4>

        <label>Ø§Ù„Ù…Ø¸Ù‡Ø±:</label>

        <select id="themeSelect" onchange="playAudio('click'); setTheme(this.value)">

            <option value="dark">Ø¯Ø§ÙƒÙ†</option><option value="light">ÙØ§ØªØ­</option><option value="purple">Ø¨Ù†ÙØ³Ø¬ÙŠ</option><option value="forest">Ø§Ù„ØºØ§Ø¨Ø©</option><option value="sunset">ØºØ±ÙˆØ¨ Ø§Ù„Ø´Ù…Ø³</option><option value="gold">Ø§Ù„Ø°Ù‡Ø¨ÙŠ</option>

        </select>

        <button class="btn" style="margin-top:20px" onclick="playAudio('click'); toggleLanguage()">ğŸŒ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</button>

        <button class="btn" style="margin-top:10px" onclick="playAudio('click'); openPassChangeModal()">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>

        <button class="btn" style="margin-top:10px; background:var(--danger)" onclick="playAudio('trash'); deleteAllFiles()">ğŸ—‘ï¸ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª</button>

        <button class="btn" style="background:#333; margin-top:15px" onclick="playAudio('click'); closeModals()">Ø¥ØºÙ„Ø§Ù‚</button>

    </div></div>

    <div id="passChangeModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary)">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ³Ø¤Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù†</h4>

        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</label>

        <input type="password" id="newPassInput" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©">

        <label>Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ù…Ø«Ø§Ù„: Ù…Ø§ Ù‡Ùˆ Ø·ÙˆÙ„ÙƒØŸ):</label>

        <input type="text" id="newSecQuestion" placeholder="Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù†">

        <label>Ø¥Ø¬Ø§Ø¨Ø© Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù†:</label>

        <input type="text" id="newSecAnswer" placeholder="Ø¥Ø¬Ø§Ø¨Ø© Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù†">

        <button class="btn" onclick="playAudio('success'); saveNewPassAndSec()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()">Ø¥Ù„ØºØ§Ø¡</button>

    </div></div>

    <div id="uploadModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary)">Ø¥Ø¶Ø§ÙØ© ÙƒØªØ§Ø¨</h4>

        <div id="pendingFileName" style="font-size:0.8rem; color:#888; margin-bottom:10px"></div>

        <label>Ø§Ù„ØªØµÙ†ÙŠÙ:</label>

        <select id="selectedCat"><option value="ÙƒØªØ¨">ÙƒØªØ¨</option><option value="Ø±ÙˆØ§ÙŠØ§Øª">Ø±ÙˆØ§ÙŠØ§Øª</option><option value="Ù…Ù„Ø®ØµØ§Øª">Ù…Ù„Ø®ØµØ§Øª</option><option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option></select>

        <label>ÙˆØµÙ Ø§Ù„ÙƒØªØ§Ø¨:</label>

        <input type="text" id="bookDescInput" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙØ§Ù‹ Ù…Ø®ØªØµØ±Ø§Ù‹">

        <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</label>

        <select id="bookRatingInput">

            <option value="5">â­â­â­â­â­ (Ù…Ù…ØªØ§Ø²)</option>

            <option value="4">â­â­â­â­ (Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹)</option>

            <option value="3">â­â­â­ (Ù…ØªÙˆØ³Ø·)</option>

            <option value="2">â­â­ (Ø¶Ø¹ÙŠÙ)</option>

            <option value="1">â­ (Ø³ÙŠØ¡)</option>

        </select>

        <button class="btn" id="confirmUploadBtn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±ÙØ¹</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()">Ø¥Ù„ØºØ§Ø¡</button>

    </div></div>

    <div id="binModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--danger)">Ø§Ù„Ø³Ù„Ø©</h4>

        <div id="binList"></div>

        <button class="btn" style="background:var(--danger)" onclick="emptyBin()">Ø¥ÙØ±Ø§Øº Ø§Ù„ÙƒÙ„</button>

        <button class="btn" style="background:#333; margin-top:10px" onclick="playAudio('click'); closeModals()">Ø¥ØºÙ„Ø§Ù‚</button>

    </div></div>

    <div id="contactModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ ğŸ“</h4>

        <a href="tel:01055662785" class="contact-btn"><span class="contact-icon">â˜ï¸</span> Ø§ØªØµØ§Ù„</a>

        <a href="https://wa.me/01055662785" class="contact-btn"><span class="contact-icon">ğŸ’¬</span> ÙˆØ§ØªØ³Ø§Ø¨</a>

        <a href="https://www.facebook.com/profile.php?id=61583039190517&locale=ar_AR" class="contact-btn"><span class="contact-icon">ğŸ“˜</span> ÙÙŠØ³Ø¨ÙˆÙƒ</a>

        <a href="https://www.instagram.com/ziadalzoz1020/" class="contact-btn"><span class="contact-icon">ğŸ“¸</span> Ø¥Ù†Ø³ØªØºØ±Ø§Ù…</a>

        <button class="btn" style="background:#333; margin-top:15px" onclick="playAudio('click'); closeModals()">Ø¥ØºÙ„Ø§Ù‚</button>

    </div></div>

    <div id="downloadBooksModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0">ØªÙ†Ø²ÙŠÙ„ ÙƒØªØ¨ ğŸ“š</h4>

        <a href="https://www.noor-book.com/" class="contact-btn"><span class="contact-icon">ğŸ“–</span> Ù…ÙƒØªØ¨Ø© Ù†ÙˆØ±</a>

        <a href="https://www.kotobati.com/" class="contact-btn"><span class="contact-icon">ğŸ“–</span> Ù…ÙƒØªØ¨Ø© ÙƒØªÙˆØ¨Ø§ØªÙŠ</a>

        <a href="https://books-library.website/" class="contact-btn"><span class="contact-icon">ğŸ“–</span> Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¹Ø±Ø¨</a>

        <a href="https://ellibrary.moe.gov.eg/" class="contact-btn"><span class="contact-icon">ğŸ“–</span> Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙˆØ²Ø§Ø±Ø©</a>

        <button class="btn" style="background:#333; margin-top:15px" onclick="playAudio('click'); closeModals()">Ø¥ØºÙ„Ø§Ù‚</button>

    </div></div>

    <div id="aboutUsModal" class="modal"><div class="modal-box">

        <h4 style="color:var(--primary); margin-top:0">Ù„Ù…Ø­Ø© Ø¹Ù†Ø§ â„¹ï¸</h4>

        <p style="text-align: center; font-size: 1rem; line-height: 1.5;">Ù…ÙƒØªØ¨Ø© Ziad Aldriny 2026 Ù‡ÙŠ Ù…ÙƒØªØ¨Ø© Ø±Ù‚Ù…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ÙˆÙ…ØªØ·ÙˆØ±Ø© Ù„ØªØ®Ø²ÙŠÙ† ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª. ØªÙ… ØªØµÙ…ÙŠÙ…Ù‡Ø§ ÙˆØªØ·ÙˆÙŠØ±Ù‡Ø§ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© Ø²ÙŠØ§Ø¯ Ø§Ù„Ø¯Ø±ÙŠÙ†ÙŠØŒ Ø§Ù„Ø°ÙŠ Ø£Ø¨Ø¯Ø¹ ÙÙŠ Ø¨Ù†Ø§Ø¡ Ù†Ø¸Ø§Ù… ÙŠØªÙŠØ­ Ø±ÙØ¹ Ø§Ù„ÙƒØªØ¨ Ø¨Ø³Ù‡ÙˆÙ„Ø©ØŒ Ø¹Ø±Ø¶Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø¬Ø°Ø§Ø¨ØŒ ÙˆÙ‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­ Ù…Ø¹ Ù…ÙŠØ²Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø«Ù„ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙˆØ§Ù„ØªÙƒØ¨ÙŠØ±. ØªÙ‡Ø¯Ù Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø¥Ù„Ù‰ ØªÙˆÙÙŠØ± ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø³Ù„Ø³Ø© ÙˆØ¢Ù…Ù†Ø©ØŒ Ù…Ø¹ Ø¯Ø¹Ù… Ù„Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ØŒ ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ© Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± ÙˆØ³Ø¤Ø§Ù„ Ø£Ù…Ø§Ù†. Ø²ÙŠØ§Ø¯ Ø§Ù„Ø¯Ø±ÙŠÙ†ÙŠ Ù‡Ùˆ Ø§Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆØ§Ù„Ù…Ø¨Ø¯Ø¹ Ø®Ù„Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŒ Ø§Ù„Ø°ÙŠ ÙŠØ¹ÙƒØ³ Ø´ØºÙÙ‡ Ø¨Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ§Ù„Ù‚Ø±Ø§Ø¡Ø©.</p>

        <button class="btn" style="margin-top:20px" onclick="playAudio('click'); shareSite()">ğŸ“¤ Ø´Ø§Ø±Ùƒ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>

        <button class="btn" style="background:#333; margin-top:15px" onclick="playAudio('click'); closeModals()">Ø¥ØºÙ„Ø§Ù‚</button>

    </div></div>

    <div id="toast"></div>

    <div class="footer">Ø¨ÙˆØ§Ø³Ø·Ø© Ziad Library &copy; 2026</div>

    <div id="pdfModal" class="ziad-reader-overlay" style="display:none;">
    <div class="reader-container">
        <header class="reader-toolbar">
            <div class="t-section">
                <button class="t-btn close-btn" onclick="closeReader()" title="Ø¥ØºÙ„Ø§Ù‚">âœ•</button>
                <div class="v-sep"></div>
                <h3 id="reader-filename">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h3>
            </div>

            <div class="t-section nav-controls">
                <button class="t-btn" id="prev-pg">â—€</button>
                <div class="page-info">
                    <input type="number" id="page-num-input" value="1" min="1">
                    <span>/</span>
                    <span id="total-pages">0</span>
                </div>
                <button class="t-btn" id="next-pg">â–¶</button>
            </div>

            <div class="t-section tools">
                <button class="t-btn" id="z-out" title="ØªØµØºÙŠØ±">â–</button>
                <span id="zoom-percent">100%</span>
                <button class="t-btn" id="z-in" title="ØªÙƒØ¨ÙŠØ±">â•</button>
                <div class="v-sep"></div>
                <button class="t-btn" id="rotate-pdf" title="ØªØ¯ÙˆÙŠØ±">ğŸ”„</button>
                <button class="t-btn" id="reader-theme" title="ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©">ğŸŒ“</button>
                <button class="t-btn" id="full-scr" title="Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©">ğŸ“º</button>
            </div>
        </header>

        <main id="viewer-viewport" class="custom-scroll">
            <div id="canvas-wrapper">
                <canvas id="pdf-canvas"></canvas>
            </div>
        </main>

        <div class="floating-actions">
            <button class="f-btn" id="auto-scroll-toggle">ğŸ–±ï¸ ØªÙ…Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
            <div class="v-sep"></div>
            <button class="f-btn" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            <button class="f-btn" id="reader-download">ğŸ“¥ ØªØ­Ù…ÙŠÙ„</button>
        </div>
    </div>
</div>

    <script>

        // Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ (JavaScript) Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ù„Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø¹Ù…Ù„

        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        

        const sounds = {

            click: "https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3",

            success: "https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3",

            trash: "https://assets.mixkit.co/active_storage/sfx/2570/2570-preview.mp3",

            error: "https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.mp3",

            popup: "https://assets.mixkit.co/active_storage/sfx/2580/2580-preview.mp3",

            engine: "https://assets.mixkit.co/active_storage/sfx/876/876-preview.mp3"

        };

        function playAudio(type) {

            const audio = new Audio(sounds[type]);

            audio.volume = 0.5;

            audio.play().catch(e => console.log("Audio blocked"));

        }

        let db;

        let currentPass = localStorage.getItem('ziadPass') || 'ziad123';

        let currentSecQuestion = localStorage.getItem('ziadSecQuestion') || 'Ù…Ø§ Ù‡Ùˆ Ø·ÙˆÙ„ÙƒØŸ';

        let currentSecAnswer = localStorage.getItem('ziadSecAnswer') || 'Ù…Ø¹Ø±ÙØ´';

        let pendingFile = null;

        const init = () => {

            const theme = localStorage.getItem('ziadTheme') || 'dark';

            const lang = localStorage.getItem('ziadLang') || 'ar';

            document.body.setAttribute('data-theme', theme);

            if (lang === 'en') {

                document.documentElement.lang = 'en';

                document.documentElement.dir = 'ltr';

            }

        };

        init();

        function setTheme(val) {

            localStorage.setItem('ziadTheme', val);

            document.body.setAttribute('data-theme', val);

        }

        function toggleLanguage() {

            const currentLang = localStorage.getItem('ziadLang') || 'ar';

            const newLang = currentLang === 'ar' ? 'en' : 'ar';

            localStorage.setItem('ziadLang', newLang);

            if (newLang === 'en') {

                document.documentElement.lang = 'en';

                document.documentElement.dir = 'ltr';

                // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†ØµÙˆØµ Ø¥Ø°Ø§ Ø£Ø±Ø¯ØªØŒ Ù„ÙƒÙ† Ù„Ù„Ø¨Ø³Ø§Ø·Ø© Ù†ØªØ±ÙƒÙ‡Ø§ ÙƒÙ…Ø§ Ù‡ÙŠ

            } else {

                document.documentElement.lang = 'ar';

                document.documentElement.dir = 'rtl';

            }

            location.reload(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª

        }

        function openSettings() { playAudio('popup'); document.getElementById('settingsModal').style.display='block'; }

        function openContact() { playAudio('popup'); document.getElementById('contactModal').style.display='block'; }

        function openDownloadBooks() { playAudio('popup'); document.getElementById('downloadBooksModal').style.display='block'; }

        function openAboutUs() { playAudio('popup'); document.getElementById('aboutUsModal').style.display='block'; }

        function shareSite() {

            if (navigator.share) {

                navigator.share({

                    title: 'Ù…ÙƒØªØ¨Ø© Ziad Aldriny 2026',

                    text: 'Ø§ÙƒØªØ´Ù Ù…ÙƒØªØ¨Ø© Ø±Ù‚Ù…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª!',

                    url: 'https://ziadalzoz1020-cpu.github.io/my-library-zi/'

                }).then(() => showToast('âœ… ØªÙ… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©'))

                .catch(() => showToast('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©'));

            } else {

                showToast('âŒ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­');

            }

        }

        function openPassChangeModal() { document.getElementById('passChangeModal').style.display = 'block'; }

        function saveNewPassAndSec() {

            const np = document.getElementById('newPassInput').value;

            const nsq = document.getElementById('newSecQuestion').value;

            const nsa = document.getElementById('newSecAnswer').value;

            if(np && nsq && nsa) {

                localStorage.setItem('ziadPass', np);

                localStorage.setItem('ziadSecQuestion', nsq);

                localStorage.setItem('ziadSecAnswer', nsa);

                currentPass = np;

                currentSecQuestion = nsq;

                currentSecAnswer = nsa;

                showToast("âœ… ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ³Ø¤Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù†");

                document.getElementById('newPassInput').value = '';

                document.getElementById('newSecQuestion').value = '';

                document.getElementById('newSecAnswer').value = '';

                closeModals();

            } else {

                showToast("âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");

            }

        }

        function deleteAllFiles() {

            if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§ØªØŸ")) {

                db.transaction("books", "readwrite").objectStore("books").clear().onsuccess = () => {

                    db.transaction("bin", "readwrite").objectStore("bin").clear().onsuccess = () => {

                        render(); updateStats(); showToast("ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª");

                    };

                };

            }

        }

        const req = indexedDB.open("Ziad_Final_2026", 1);

        req.onupgradeneeded = (e) => {

            const d = e.target.result;

            d.createObjectStore("books", {keyPath: "id", autoIncrement: true});

            d.createObjectStore("bin", {keyPath: "id", autoIncrement: true});

        };

        req.onsuccess = (e) => { 

            db = e.target.result; 

            updateStats();

            setTimeout(() => {

                document.getElementById('loader').classList.add('fade-out');

                setTimeout(() => document.getElementById('loader').style.display='none', 1000);

            }, 2000);

        };

        function showToast(m) {

            const t = document.getElementById('toast'); t.innerText = m;

            t.style.display = 'block'; setTimeout(() => t.style.display = 'none', 3000);

        }

        function showPage(id) {

            ['loginPage', 'secPage', 'libraryContent'].forEach(p => document.getElementById(p).style.display = 'none');

            document.getElementById(id).style.display = 'block';

            const fBadge = document.getElementById('floatingBadge');

            const sBtn = document.getElementById('sidebarToggle');

            if (id === 'libraryContent') { fBadge.style.display = 'block'; sBtn.style.display = 'block'; }

            else { fBadge.style.display = 'none'; sBtn.style.display = 'none'; }

        }

        function login() {

            if(document.getElementById('passIn').value === currentPass) { 

                playAudio('engine');

                showPage('libraryContent'); 

                render(); 

            } else {

                playAudio('error');

                showToast("âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£");

            }

        }

        function checkSec() {

            if(document.getElementById('secAns').value === currentSecAnswer) {

                playAudio('engine');

                showPage('libraryContent'); 

                showToast("Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ù‡Ùˆ: " + currentPass); 

                render();

            } else {

                playAudio('error');

                showToast("âš ï¸ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø·Ø£");

            }

        }

        function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display='none'); }

        function upload(e) {

            pendingFile = e.target.files[0];

            if(!pendingFile) return;

            playAudio('popup');

            document.getElementById('pendingFileName').innerText = pendingFile.name;

            document.getElementById('uploadModal').style.display = 'block';

        }

        document.getElementById('confirmUploadBtn').onclick = async () => {

            const cat = document.getElementById('selectedCat').value;

            const desc = document.getElementById('bookDescInput').value || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ";

            const rating = document.getElementById('bookRatingInput').value;

            const file = pendingFile;

            closeModals();

            showToast("â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...");

            

            const r = new FileReader();

            r.onload = async (ev) => {

                const thumb = await genThumb(ev.target.result);

                const tx = db.transaction("books", "readwrite");

                tx.objectStore("books").add({ 

                    name: file.name.replace('.pdf',''), 

                    data: ev.target.result, 

                    thumb, size: file.size, 

                    category: cat,

                    description: desc,

                    rating: rating,

                    date: new Date().toLocaleDateString('ar-EG') 

                });

                tx.oncomplete = () => { 

                    playAudio('success');

                    render(); updateStats(); showToast("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸"); 

                    document.getElementById('bookDescInput').value = '';

                };

            };

            r.readAsDataURL(file);

        };

        async function genThumb(data) {

            try {

                const pdf = await pdfjsLib.getDocument(data).promise;

                const page = await pdf.getPage(1);

                const canv = document.createElement('canvas');

                const view = page.getViewport({scale: 0.3});

                canv.width = view.width; canv.height = view.height;

                await page.render({canvasContext: canv.getContext('2d'), viewport: view}).promise;

                return canv.toDataURL('image/jpeg', 0.6);

            } catch { return ''; }

        }

        function render() {

            const g = document.getElementById('grid');

            const q = document.getElementById('search').value.toLowerCase();

            const s = document.getElementById('sort').value;

            const cf = document.getElementById('catFilter').value;

            g.innerHTML = "";

            const tx = db.transaction("books", "readonly");

            let books = [];

            tx.objectStore("books").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) { 

                    const nameMatch = c.value.name.toLowerCase().includes(q);

                    const descMatch = c.value.description && c.value.description.toLowerCase().includes(q);

                    if((nameMatch || descMatch) && (cf === 'all' || c.value.category === cf)) books.push(c.value); 

                    c.continue(); 

                } else {

                    books.sort((a,b) => s === 'az' ? a.name.localeCompare(b.name) : b.id - a.id);

                    books.forEach(b => {

                        const d = document.createElement('div'); d.className = 'card';

                        const stars = "â­".repeat(b.rating || 5);

                        d.innerHTML = `

                            <div class="card-tag">${b.category || 'ÙƒØªØ¨'}</div>

                            <img src="${b.thumb || 'https://via.placeholder.com/150'}" class="preview" onclick="playAudio('popup'); viewB(${b.id})">

                            <input class="title-edit" value="${b.name}" onchange="updateTitle(${b.id}, this.value)">

                            <div class="book-rating">${stars}</div>

                            <div class="book-description">${b.description || "Ø¨Ø¯ÙˆÙ† ÙˆØµÙ"}</div>

                            <div class="book-meta">ğŸ“… ${b.date} | ${formatSize(b.size)}</div>

                            <div class="card-btns">

                                <button class="btn-s" style="background:var(--primary); color:#000" onclick="playAudio('popup'); viewB(${b.id})">ÙØªØ­</button>

                                <button class="btn-s" style="background:#333" onclick="playAudio('click'); downB(${b.id})">ØªÙ†Ø²ÙŠÙ„</button>

                                <button class="btn-s" style="background:var(--danger); grid-column: span 2" onclick="playAudio('trash'); moveToBin(${b.id})">Ø­Ø°Ù</button>

                            </div>`;

                        g.appendChild(d);

                    });

                }

            };

        }

        let currentPdfUrl = null; // Ù„ØªØ®Ø²ÙŠÙ† URL Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„ØªØ­Ù…ÙŠÙ„

        function viewB(id) {

            db.transaction("books").objectStore("books").get(id).onsuccess = (e) => {

                const b = e.target.result;

                const blob = dataURLtoBlob(b.data);

                currentPdfUrl = URL.createObjectURL(blob); // Ø­ÙØ¸ Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§

                openReader(currentPdfUrl, b.name);

            };

        }

        function downB(id) {

            db.transaction("books").objectStore("books").get(id).onsuccess = (e) => {

                const b = e.target.result;

                const a = document.createElement('a'); a.href = b.data; a.download = b.name + ".pdf"; a.click();

            };

        }

        function updateTitle(id, val) {

            const tx = db.transaction("books", "readwrite");

            const store = tx.objectStore("books");

            store.get(id).onsuccess = (e) => {

                const data = e.target.result;

                data.name = val;

                store.put(data);

                playAudio('success');

                showToast("ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…");

            };

        }

        function dataURLtoBlob(dataurl) {

            var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],

                bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);

            while(n--) u8arr[n] = bstr.charCodeAt(n);

            return new Blob([u8arr], {type:mime});

        }

        function moveToBin(id) {

            const tx = db.transaction(["books", "bin"], "readwrite");

            tx.objectStore("books").get(id).onsuccess = (e) => {

                tx.objectStore("bin").add(e.target.result);

                tx.objectStore("books").delete(id);

                tx.oncomplete = () => { render(); updateStats(); showToast("ØªÙ… Ø§Ù„Ù†Ù‚Ù„ Ù„Ù„Ø³Ù„Ø©"); };

            };

        }

        function showBin() {

            const list = document.getElementById('binList'); list.innerHTML = "";

            document.getElementById('binModal').style.display = 'block';

            db.transaction("bin").objectStore("bin").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) {

                    const row = document.createElement('div'); row.style = "display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #333; align-items:center";

                    row.innerHTML = `<span style="font-size:0.9rem">${c.value.name}</span> <button class="btn-s" style="background:#198754; padding:5px 10px" onclick="playAudio('success'); restoreBook(${c.value.id})">Ø§Ø³ØªØ¹Ø§Ø¯Ø©</button>`;

                    list.appendChild(row); c.continue();

                }

            };

        }

        function restoreBook(id) {

            const tx = db.transaction(["books", "bin"], "readwrite");

            tx.objectStore("bin").get(id).onsuccess = (e) => {

                tx.objectStore("books").add(e.target.result);

                tx.objectStore("bin").delete(id);

                tx.oncomplete = () => { showBin(); render(); updateStats(); };

            };

        }

        function emptyBin() {

            if(confirm("Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠØŸ")) {

                playAudio('trash');

                db.transaction("bin", "readwrite").objectStore("bin").clear().onsuccess = () => {

                    closeModals(); updateStats(); showToast("ØªÙ… Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ");

                };

            }

        }

        function updateStats() {

            let total = 0;

            const tx = db.transaction(["books", "bin"], "readonly");

            tx.objectStore("books").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) { total += (c.value.size || 0); c.continue(); }

                else document.getElementById('totalStorage').innerText = formatSize(total);

            };

            tx.objectStore("bin").count().onsuccess = (e) => document.getElementById('binCount').innerText = e.target.result;

        }

        function formatSize(bytes) {

            if(!bytes) return '0 B';

            const i = Math.floor(Math.log(bytes) / Math.log(1024));

            return (bytes / Math.pow(1024, i)).toFixed(1) + ' ' + ['B', 'KB', 'MB', 'GB'][i];

        }

        function exportData() {

            const tx = db.transaction("books", "readonly");

            const data = [];

            tx.objectStore("books").openCursor().onsuccess = (e) => {

                const c = e.target.result;

                if(c) { data.push(c.value); c.continue(); }

                else {

                    const a = document.createElement('a');

                    a.href = URL.createObjectURL(new Blob([JSON.stringify(data)], {type: "application/json"}));

                    a.download = "Ziad_Library_Backup.json"; a.click();

                }

            };

        }

        function importData(e) {

            const reader = new FileReader();

            reader.onload = (ev) => {

                const data = JSON.parse(ev.target.result);

                const tx = db.transaction("books", "readwrite");

                data.forEach(item => tx.objectStore("books").add(item));

                tx.oncomplete = () => { playAudio('success'); render(); updateStats(); showToast("ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­"); };

            };

            reader.readAsText(e.target.files[0]);

        }

// Sidebar Toggle

document.getElementById('sidebarToggle').onclick = () => {

    const sidebar = document.getElementById('sidebar');

    sidebar.classList.toggle('open');

};

// Close sidebar on click outside

document.addEventListener('click', function(event) {

    const sidebar = document.getElementById('sidebar');

    const toggle = document.getElementById('sidebarToggle');

    if (sidebar.classList.contains('open') && !sidebar.contains(event.target) && !toggle.contains(event.target)) {

        sidebar.classList.remove('open');

    }

});

// Ù…Ù†Ø·Ù‚ Ù…Ø´ØºÙ„ Ø²ÙŠØ§Ø¯ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ
let pdfDoc = null,
    pageNum = 1,
    pageIsRendering = false,
    pageNumIsPending = null,
    scale = 1.5,
    rotation = 0,
    autoScrollIdx = null;

const canvas = document.getElementById('pdf-canvas'),
      ctx = canvas.getContext('2d');

// ÙØªØ­ Ø§Ù„Ù‚Ø§Ø±Ø¦
function openReader(url, title) {
    document.getElementById('pdfModal').style.display = 'block';
    document.getElementById('reader-filename').innerText = title || "ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯";
    document.body.style.overflow = 'hidden'; // Ù…Ù†Ø¹ Ø³ÙƒØ±ÙˆÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

    pdfjsLib.getDocument(url).promise.then(pdfDoc_ => {
        pdfDoc = pdfDoc_;
        document.getElementById('total-pages').innerText = pdfDoc.numPages;
        renderPage(pageNum);
    });
}

// Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø©
function renderPage(num) {
    pageIsRendering = true;
    pdfDoc.getPage(num).then(page => {
        const viewport = page.getViewport({ scale, rotation });
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        const renderCtx = { canvasContext: ctx, viewport };
        page.render(renderCtx).promise.then(() => {
            pageIsRendering = false;
            if (pageNumIsPending !== null) {
                renderPage(pageNumIsPending);
                pageNumIsPending = null;
            }
        });
    });
    document.getElementById('page-num-input').value = num;
}

// Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙØ­Ø§Øª
document.getElementById('prev-pg').onclick = () => { if (pageNum <= 1) return; pageNum--; renderPage(pageNum); };
document.getElementById('next-pg').onclick = () => { if (pageNum >= pdfDoc.numPages) return; pageNum++; renderPage(pageNum); };

// Ø§Ù„Ø²ÙˆÙ…
document.getElementById('z-in').onclick = () => { scale += 0.2; renderPage(pageNum); updateZoomLabel(); };
document.getElementById('z-out').onclick = () => { if(scale <= 0.5) return; scale -= 0.2; renderPage(pageNum); updateZoomLabel(); };
function updateZoomLabel() { document.getElementById('zoom-percent').innerText = `${Math.round(scale * 100)}%`; }

// Ø§Ù„ØªØ¯ÙˆÙŠØ±
document.getElementById('rotate-pdf').onclick = () => { rotation = (rotation + 90) % 360; renderPage(pageNum); };

// Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
document.getElementById('full-scr').onclick = () => {
    let elem = document.getElementById('pdfModal');
    if (!document.fullscreenElement) elem.requestFullscreen();
    else document.exitFullscreen();
};

// Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
let themes = ['', 'mode-sepia', 'mode-dark'];
let currentTheme = 0;
document.getElementById('reader-theme').onclick = () => {
    currentTheme = (currentTheme + 1) % themes.length;
    document.getElementById('viewer-viewport').className = 'custom-scroll ' + themes[currentTheme];
};

// Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
document.getElementById('auto-scroll-toggle').onclick = function() {
    if(autoScrollIdx) {
        clearInterval(autoScrollIdx); autoScrollIdx = null;
        this.innerText = "ğŸ–±ï¸ ØªÙ…Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ";
    } else {
        this.innerText = "ğŸ›‘ Ø¥ÙŠÙ‚Ø§Ù";
        autoScrollIdx = setInterval(() => {
            document.getElementById('viewer-viewport').scrollTop += 1;
        }, 30);
    }
};

// Ø¥ØºÙ„Ø§Ù‚
function closeReader() {
    document.getElementById('pdfModal').style.display = 'none';
    document.body.style.overflow = 'auto';
    if(autoScrollIdx) clearInterval(autoScrollIdx);
}

// Ø§Ù„Ù‚ÙØ² Ù„Ù„ØµÙØ­Ø©
document.getElementById('page-num-input').onchange = function() {
    let val = parseInt(this.value);
    if(val > 0 && val <= pdfDoc.numPages) { pageNum = val; renderPage(pageNum); }
};

// Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯ Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
window.addEventListener('keydown', (e) => {
    if(document.getElementById('pdfModal').style.display === 'block') {
        if(e.key === 'ArrowRight') document.getElementById('next-pg').click();
        if(e.key === 'ArrowLeft') document.getElementById('prev-pg').click();
        if(e.key === '+') document.getElementById('z-in').click();
        if(e.key === '-') document.getElementById('z-out').click();
        if(e.key === 'Escape') closeReader();
    }
});

// Ø¥Ø¶Ø§ÙØ© ØªØ­Ù…ÙŠÙ„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø´ØºÙ„
document.getElementById('reader-download').onclick = () => {
    if (currentPdfUrl) {
        const a = document.createElement('a');
        a.href = currentPdfUrl;
        a.download = document.getElementById('reader-filename').innerText + '.pdf';
        a.click();
    } else {
        showToast("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„");
    }
};

    </script>

</body>

</html>